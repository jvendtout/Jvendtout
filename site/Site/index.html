<!DOCTYPE html>
<html lang="fr">
<head>
<link href="https://fonts.googleapis.com/css2?family=Inter&family=Poppins&family=Lato&display=swap" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #520670, #210641);
      min-height: 100vh;
      margin: 0;
      padding: 60px 1rem 1rem; /* Top padding pour le banner fixe */
      color: white;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      min-height: calc(100vh - 80px);
      padding: 1rem;
    }

    /* Top Banner Style Amazon */
    .top-banner {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 999;
      background: linear-gradient(135deg, #2e003e, #4b1a7f);
      padding: 8px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      border-bottom: 1px solid rgba(255, 211, 105, 0.2);
      min-height: 50px;
    }

    .banner-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .banner-logo {
      font-size: 18px;
      font-weight: 600;
      color: #ffd369;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .banner-nav {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .banner-nav button {
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      color: white;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .banner-nav button:hover {
      background: rgba(255, 211, 105, 0.2);
      color: #ffd369;
      transform: translateY(-1px);
    }

    .banner-nav button.active {
      background: #ffd369;
      color: #2e003e;
      font-weight: 600;
    }

    .banner-nav img {
      width: 12px;
      height: 12px;
    }

    /* Cacher les anciens éléments */
    .hamburger, .sidebar {
      display: none !important;
    }

    /* Menu latéral */
    .sidebar {
      position: fixed;
      top: 0;
      left: -280px;
      width: 280px;
      height: 100vh;
      background: linear-gradient(135deg, #2e003e, #4b1a7f);
      backdrop-filter: blur(15px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      padding: 4rem 1.5rem 2rem;
      z-index: 1000;
      transition: left 0.3s ease;
      overflow-y: auto;
      box-shadow: 4px 0 20px rgba(0, 0, 0, 0.3);
    }

    .sidebar.open {
      left: 0;
    }

    .sidebar button {
      display: block;
      width: 100%;
      padding: 16px 20px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      margin-bottom: 12px;
      transition: all 0.3s ease;
      font-size: 16px;
      font-weight: 500;
      text-align: left;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }

    .sidebar button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.5s;
    }

    .sidebar button:hover::before {
      left: 100%;
    }

    .sidebar button:hover {
      background: linear-gradient(135deg, rgba(255, 211, 105, 0.2), rgba(255, 179, 71, 0.1));
      color: #ffd369;
      transform: translateX(8px) scale(1.02);
      box-shadow: 0 6px 20px rgba(255, 211, 105, 0.3);
      border-color: rgba(255, 211, 105, 0.4);
    }

    .sidebar button.active {
      background: linear-gradient(135deg, #ffd369, #ffb347);
      color: #2e003e;
      font-weight: 600;
      transform: translateX(12px) scale(1.05);
      box-shadow: 0 8px 25px rgba(255, 211, 105, 0.5);
      border-color: #ffd369;
    }

    .sidebar button.active::before {
      display: none;
    }

    /* Menu horizontal responsive */
    .menu-horizontal {
      display: none;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Responsive du banner */
    @media (max-width: 768px) {
      .banner-nav {
        gap: 4px;
      }
      
      .banner-nav button {
        padding: 4px 8px;
        font-size: 11px;
      }
      
      .banner-logo {
        font-size: 16px;
      }
      
      .banner-nav img {
        width: 10px;
        height: 10px;
      }
      
      .top-banner {
        padding: 6px 8px;
        min-height: 44px;
      }
      
      body {
        padding-top: 54px;
      }
      
      .container {
        min-height: calc(100vh - 70px);
      }
    }

    @media (max-width: 480px) {
      .banner-nav button span {
        display: none; /* Cacher le texte sur très petit écran */
      }
      
      .banner-nav {
        gap: 2px;
      }
      
      .banner-nav button {
        padding: 4px 6px;
        min-width: 32px;
        justify-content: center;
      }
    }

    @media (min-width: 768px) {
      /* Menu hamburger toujours visible */
      .hamburger {
        display: block;
      }
      
      .menu-horizontal {
        display: flex;
      }
      
      /* Sidebar accessible sur desktop aussi */
      .sidebar {
        display: block;
      }
    }

    .menu-horizontal button {
      background: #4b1a7f;
      color: #8ef58e;
      border: none;
      border-radius: 4px;
      padding: 8px 16px;
      font-weight: bold;
      cursor: pointer;
      text-align: left;
      white-space: nowrap;
      transition: all 0.3s;
    }

    .menu-horizontal button:hover {
      background: #6a2c93;
      transform: translateY(-2px);
    }

    .menu-horizontal button.active {
      background: #8ef58e;
      color: #2e003e;
    }

    /* Contenu principal */
    .main-content {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .content-section {
      display: none;
    }

    .content-section.active {
      display: block;
    }

    /* Contrôles de filtre */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: center;
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem;
      border-radius: 12px;
      margin-bottom: 2rem;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      z-index: 100;
    }

    .search-container {
      display: flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 8px 12px;
      flex: 1;
      min-width: 200px;
    }

    #search-input {
      background: transparent;
      border: none;
      outline: none;
      color: white;
      flex: 1;
      padding: 4px 8px;
    }

    #search-input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .search-icon {
      color: #ffd369;
      margin-right: 8px;
    }

    /* Boutons de contrôle */
    .control-btn {
      background: #4b1a7f;
      color: #8ef58e;
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .control-btn:hover {
      background: #6a2c93;
      transform: translateY(-2px);
    }

    /* Dropdowns de tri */
    .sort-dropdown {
      position: relative;
      display: inline-block;
      z-index: 9998 !important;
    }

    .sort-dropdown.active {
      z-index: 9999 !important;
    }

    .dropdown-arrow {
      font-size: 12px;
      transition: transform 0.3s;
    }

    .sort-dropdown.active .dropdown-arrow {
      transform: rotate(180deg);
    }

    .sort-options {
      position: absolute;
      top: 100%;
      left: 0;
      min-width: 180px;
      background: rgba(46, 0, 79, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      z-index: 99999 !important;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s;
    }

    .sort-dropdown.active .sort-options {
      opacity: 1;
      visibility: visible;
      transform: translateY(5px);
    }

    .sort-option {
      padding: 12px 16px;
      cursor: pointer;
      color: #fff;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .sort-option:last-child {
      border-bottom: none;
    }

    .sort-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .sort-option.active {
      background: rgba(106, 44, 147, 0.5);
      color: #8ef58e;
      font-weight: 600;
    }

    /* Grille de produits */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      grid-auto-rows: max-content;
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .product-card {
      background: linear-gradient(135deg, #2e004f, #1976d2);
      border-radius: 12px;
      padding: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.3s;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
 
    .product-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #8ef58e, #ffd369);
    }

    .product-card:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .product-card img,
    .product-card video {
      width: 100%;
      height: 120px;
      object-fit: contain;
      border-radius: 8px;
      margin-bottom: 12px;
      background: rgba(255, 255, 255, 0.1);
    }

    /* Cas spécial pour les cartes sans image */
    .product-card.no-image {
      min-height: auto;
    }

    .product-card.no-image .product-info {
      padding-top: 8px;
    }

    .product-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex: 1;
    }

    .product-name {
      font-weight: bold;
      color: #ffd369;
      font-size: 1em;
      line-height: 1.2;
      max-height: calc(1.2em * 3); /* Limiter à 3 lignes */
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .product-description {
      color: #8ef58e;
      font-size: 0.9em;
      line-height: 1.4;
      opacity: 0.9;
    }

    .product-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: auto;
      padding-top: 0px;
    }

    .product-price {
      color: #ff6b6b;
      font-weight: bold;
      font-size: 1.2em;
    }

    .product-status {
      background: #8ef58e;
      color: #2e003e;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8em;
      font-weight: bold;
    }

    .add-to-cart-btn {
      background: #8ef58e;
      color: #2e003e;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
    }

    .add-to-cart-btn:hover {
      background: #7ae67a;
      transform: scale(1.05);
    }

    /* Modales à droite style static-index.html */
    .modal.hidden { 
      display: none !important; 
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      z-index: 1000;
      pointer-events: none;
    }

    .modal.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Modales côté droit - TOUTES les modales demandées */
    .modal.show#product-modal,
    .modal.show#cart-modal,
    .modal.show#arnaqueur-modal,
    .modal.show#category-modal,
    .modal.show#filter-modal,
    .modal.show#add-review-modal,
    .modal.show#product-selection-modal,
    .modal.show#review-detail-modal {
      justify-content: flex-end;
      align-items: stretch;
    }

    .modal.show#product-modal .modal-content,
    .modal.show#cart-modal .modal-content,
    .modal.show#arnaqueur-modal .modal-content,
    .modal.show#category-modal .modal-content,
    .modal.show#filter-modal .modal-content,
    .modal.show#add-review-modal .modal-content,
    .modal.show#review-detail-modal .modal-content {
      width: 400px;
      max-width: 100%;
      height: 100%;
      margin: 0;
      border-radius: 0;
    }

    /* Modal de sélection de produit plus large */
    .modal.show#product-selection-modal .modal-content {
      width: 600px;
      max-width: 100%;
      height: 100%;
      margin: 0;
      border-radius: 0;
    }

    /* Modales centrées */
    .modal.show#media-selection-modal {
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      padding: 20px;
      height: 100%;
      box-sizing: border-box;
      position: relative;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #2e003e, #6a0572);
      color: white;
      border-radius: 0;
      max-width: none;
      max-height: none;
      overflow-y: auto;
      border: none;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
      pointer-events: auto;
    }

    .modal .close {
      position: absolute;
      right: 15px;
      top: 10px;
      cursor: pointer;
      font-size: 24px;
      background: none;
      border: none;
      color: white;
    }

    /* Style panier */
    #cart-modal .modal-content {
      background: linear-gradient(135deg, #2e003e, #6a0572) !important;
      color: white;
      border-radius: 0;
      padding: 0;
      font-family: 'Poppins', sans-serif;
      display: flex;
      flex-direction: column;
      height: 100%;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    }

    .cart-modal-content {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .cart-main-content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }

    .cart-commander-btn {
      position: sticky;
      bottom: 0;
      width: 100%;
      padding: 18px 20px;
      margin: 0;
      background: linear-gradient(135deg, #FFFC00, #FFF700);
      color: #000;
      border: none;
      border-radius: 0 0 10px 10px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 -4px 15px rgba(255, 252, 0, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-commander-btn:hover {
      background: linear-gradient(135deg, #FFF700, #FFFC00);
      transform: translateY(-2px);
      box-shadow: 0 -6px 20px rgba(255, 252, 0, 0.4);
    }

    .cart-commander-btn img {
      transition: transform 0.3s ease;
      background: #000;
      border-radius: 50%;
      padding: 2px;
      width: 28px;
      height: 28px;
    }

    .cart-commander-btn:hover img {
      transform: scale(1.1);
    }

    #cart-list li {
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    #cart-list button {
      background: #ffd369;
      color: #000;
      border: none;
      padding: 5px 10px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }

    #cart-list button:hover {
      background: #fcbf49;
      transform: scale(1.05);
    }

    /* Style modal produit amélioré */
    #product-modal .modal-content {
      background: linear-gradient(135deg, #2e003e, #6a0572) !important;
      color: white;
      padding: 20px;
      font-family: 'Poppins', sans-serif;
      border-radius: 0 !important;
      height: 100% !important;
    }

    #product-modal h2 {
      color: #ffd369;
      font-size: 1.4em;
      margin-bottom: 15px;
      font-weight: 600;
    }

    #product-modal p {
      color: #8ef58e;
      line-height: 1.5;
      margin-bottom: 15px;
    }

    /* Galerie media dans la modal - adaptative */
    .media-gallery {
      margin-bottom: 20px;
      max-height: 60vh; /* Limiter la hauteur pour éviter les coupures */
      overflow-y: auto; /* Scroll si nécessaire */
    }

    .media-item {
      margin-bottom: 15px;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .media-item img,
    .media-item video {
      width: 100%;
      max-height: 200px; /* Hauteur maximum réduite */
      object-fit: contain; /* Contenir l'image entière sans couper */
      border-radius: 8px;
      transition: transform 0.3s;
      background: rgba(0,0,0,0.1); /* Fond pour les espaces vides */
    }

    .media-item:hover img,
    .media-item:hover video {
      transform: scale(1.02);
    }

    /* Controles panier dans modal produit - repositionnés */
    #cart-controls {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      margin: 15px 0; /* Margin avant et après */
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 10px;
    }

    #cart-controls button {
      transition: all 0.3s;
    }

    #cart-controls #add-to-cart {
      background: linear-gradient(45deg, #ffd369, #fcbf49);
      color: #2e003e;
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(255, 211, 105, 0.3);
    }

    #cart-controls #add-to-cart:hover {
      background: #ffdb4d;
      transform: translateY(-1px);
    }

    #cart-controls #remove-one {
      background: #ff6b6b;
      border: none;
      color: white;
      border-radius: 4px;
      padding: 6px 12px;
      font-size: 14px;
      cursor: pointer;
    }

    #cart-controls #remove-one:hover {
      background: #ff5252;
    }

    #cart-controls #item-qty {
      background: #ffd369;
      color: #333;
      padding: 4px 12px;
      border-radius: 4px;
      font-weight: bold;
    }

    /* Mobile responsive */
    @media screen and (max-width: 650px) {
      .modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        width: 100%;
        height: 100%;
        margin: 0;
        max-width: none;
        z-index: 1000;
      }
      
      .media-item img,
      .media-item video {
        max-height: 150px; /* Hauteur encore plus réduite sur mobile */
      }
      
      .media-gallery {
        max-height: 40vh; /* Hauteur réduite sur mobile */
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .modal-title {
      color: #ffd369;
      font-size: 1.4em;
      font-weight: 600;
      margin: 0;
    }

    .close-btn {
      background: #ff6b6b;
      color: white;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
    }

    .close-btn:hover {
      background: #e74c3c;
      transform: scale(1.1);
    }

    /* Panier */
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      margin-bottom: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .cart-item-details {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .item-name {
      font-weight: 600;
      color: #fff;
      font-size: 14px;
    }

    .item-pricing {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .unit-price {
      font-size: 12px;
      color: #a0a0a0;
    }

    .total-price {
      font-size: 14px;
      font-weight: 600;
      color: #ffd369;
    }

    .quantity-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .qty-btn {
      width: 28px;
      height: 28px;
      border: none;
      border-radius: 6px;
      background: #6a2c93;
      color: white;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .qty-btn:hover:not(:disabled) {
      background: #8b3db8;
      transform: scale(1.1);
    }

    .qty-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .quantity {
      min-width: 24px;
      text-align: center;
      font-weight: 600;
      color: #8ef58e;
    }

    .remove-btn {
      width: 32px;
      height: 32px;
      border: none;
      border-radius: 6px;
      background: #ff6b6b;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      margin-left: 8px;
    }

    .remove-btn:hover {
      background: #ff5252;
      transform: scale(1.1);
    }

    .cart-total {
      font-size: 1.2em;
      font-weight: bold;
      color: #ffd369;
      text-align: center;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      margin-top: 1rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
      }
      
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .search-container {
        min-width: 100%;
      }

      /* Modales responsive - TOUTES les modales prennent tout l'écran sur mobile */
      .modal.show .modal-content {
        width: 100% !important;
        height: 100% !important;
        border-radius: 0 !important;
        max-width: 100% !important;
        max-height: 100% !important;
      }
      
      .modal.show {
        justify-content: stretch !important;
        align-items: stretch !important;
      }
    }

    @media (max-width: 480px) {
      .products-grid {
        grid-template-columns: 1fr;
      }
      
      .container {
        padding: 0.5rem;
      }
      
      .modal-content {
        margin: 1rem;
        padding: 1rem;
      }
    }

    /* Styles pour les preuves */
    .proof-card {
      background: linear-gradient(135deg, #2e004f, #1976d2);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s;
      cursor: pointer;
      border: 1px solid #8ef58e;
      position: relative;
    }

    .proof-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #8ef58e, #ffd369);
    }

    .proof-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .proof-header {
      display: flex;
      align-items: center;
      margin-bottom: 16px;
    }

    .proof-avatar {
      background: #8ef58e;
      color: #2e003e;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 12px;
      font-size: 1.2em;
    }

    .proof-user-info {
      flex: 1;
    }

    .proof-username {
      font-weight: bold;
      color: #8ef58e;
      font-size: 1.1em;
      margin: 0;
    }

    .proof-date {
      color: #ffd369;
      font-size: 0.85em;
      margin: 2px 0 0 0;
    }

    .proof-title {
      color: #ffd369;
      margin: 0 0 12px 0;
      font-size: 1.2em;
      line-height: 1.3;
      font-weight: 600;
    }

    .proof-testimonial {
      background: rgba(142, 245, 142, 0.1);
      padding: 12px;
      border-radius: 8px;
      border-left: 4px solid #8ef58e;
      margin: 16px 0;
    }

    .proof-testimonial p {
      color: #fff;
      margin: 0;
      line-height: 1.5;
      font-style: italic;
    }

    .proof-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }

    .proof-rating {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .proof-star {
      color: #ffd369;
      font-size: 1.2em;
    }

    .proof-rating-text {
      color: #8ef58e;
      margin-left: 8px;
      font-size: 0.9em;
    }

    .proof-verified {
      background: #8ef58e;
      color: #2e003e;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8em;
      font-weight: bold;
    }

    /* Notice pour avis en attente */
    .pending-admin-notice {
      text-align: center;
      margin: 1rem 0;
      padding: 12px;
      background: rgba(255, 107, 107, 0.1);
      border: 1px solid #ff6b6b;
      border-radius: 8px;
      color: #ff6b6b;
      font-weight: 500;
    }

    /* Modal d'ajout d'avis */
    #add-review-modal .modal-content {
      background: linear-gradient(145deg, #1a0b2e, #16213e) !important;
      color: white;
      border-radius: 0;
      padding: 0;
      border: none;
      backdrop-filter: blur(20px);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .add-review-header {
      background: linear-gradient(135deg, #8ef58e, #6ad66a);
      color: #1a0b2e;
      padding: 20px 30px;
      border-radius: 20px 20px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 15px rgba(142, 245, 142, 0.2);
    }

    .add-review-title {
      font-size: 24px;
      font-weight: 700;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 12px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .title-icon {
      font-size: 28px;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
    }

    .add-review-close {
      background: rgba(26, 11, 46, 0.1);
      color: #1a0b2e;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .add-review-close:hover {
      background: rgba(26, 11, 46, 0.2);
      transform: rotate(90deg) scale(1.1);
    }

    /* Formulaire d'ajout d'avis */
    .add-review-form {
      background: transparent;
      padding: 30px;
      border-radius: 0;
      border: none;
      backdrop-filter: none;
      overflow-y: auto;
      max-height: calc(90vh - 80px);
    }

    .form-row {
      display: flex;
      gap: 1rem;
      align-items: end;
      margin-bottom: 1rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group.half {
      flex: 1;
    }

    .form-group.checkbox-group {
      flex: 0 0 auto;
    }

    .form-group label {
      display: block;
      color: #8ef58e;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .form-group input[type="text"],
    .form-group textarea {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(142, 245, 142, 0.3);
      border-radius: 12px;
      color: white;
      font-size: 14px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      box-sizing: border-box;
    }

    .form-group input[type="text"]:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #8ef58e;
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 20px rgba(142, 245, 142, 0.2);
    }

    .form-group input[type="text"]::placeholder,
    .form-group textarea::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .required {
      color: #ff6b6b;
      font-weight: 600;
    }

    .form-group input[type="text"],
    .form-group textarea {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(142, 245, 142, 0.3);
      border-radius: 12px;
      color: white;
      font-size: 14px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .form-group input[type="text"]:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #8ef58e;
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 20px rgba(142, 245, 142, 0.2);
    }

    .form-group input[type="text"]::placeholder,
    .form-group textarea::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .optional {
      color: rgba(255, 255, 255, 0.6);
      font-weight: 400;
      font-size: 12px;
    }

    .required {
      color: #ff6b6b;
      font-weight: 600;
    }

    /* Checkbox personnalisée */
    .checkbox-label {
      display: flex !important;
      align-items: center;
      cursor: pointer;
      user-select: none;
      color: #fff;
      font-size: 14px;
    }

    .checkbox-label input[type="checkbox"] {
      display: none;
    }

    .checkmark {
      width: 20px;
      height: 20px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(142, 245, 142, 0.3);
      border-radius: 4px;
      margin-right: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .checkbox-label input[type="checkbox"]:checked + .checkmark {
      background: linear-gradient(135deg, #8ef58e, #ffd369);
      border-color: #8ef58e;
    }

    .checkbox-label input[type="checkbox"]:checked + .checkmark::after {
      content: '✓';
      color: #1a1a1a;
      font-weight: bold;
      font-size: 14px;
    }

    /* Sélecteur personnalisé */
    .custom-select {
      position: relative;
      display: block;
    }

    .custom-select select {
      width: 100%;
      padding: 12px 40px 12px 16px;
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid rgba(142, 245, 142, 0.2);
      border-radius: 10px;
      color: #fff;
      font-size: 14px;
      appearance: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .custom-select select:focus {
      outline: none;
      border-color: #8ef58e;
      box-shadow: 0 0 15px rgba(142, 245, 142, 0.3);
    }

    .select-arrow {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #8ef58e;
      pointer-events: none;
      transition: transform 0.3s ease;
    }

    .custom-select:hover .select-arrow {
      transform: translateY(-50%) rotate(180deg);
    }

    /* Groupe rating */
    .rating-group {
      background: rgba(255, 211, 105, 0.1);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(255, 211, 105, 0.2);
    }

    .rating-text {
      color: #ffd369;
      font-weight: 500;
      margin-left: 10px;
      font-size: 13px;
    }

    .form-group input:not([type="checkbox"]), .form-group textarea {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid rgba(142, 245, 142, 0.2);
      background: rgba(255, 255, 255, 0.08);
      border-radius: 10px;
      color: #fff;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .form-group input:not([type="checkbox"]):focus, .form-group textarea:focus {
      outline: none;
      border-color: #8ef58e;
      box-shadow: 0 0 15px rgba(142, 245, 142, 0.3);
      background: rgba(255, 255, 255, 0.12);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
      font-family: inherit;
    }

    .submit-review-btn {
      background: linear-gradient(135deg, #8ef58e, #ffd369);
      color: #1a1a1a;
      border: none;
      padding: 16px 32px;
      border-radius: 12px;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 1rem;
    }

    .submit-review-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(142, 245, 142, 0.4);
    }

    .btn-icon {
      font-size: 18px;
    }

    /* Sélecteur de produit stylisé */
    .product-selector {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .selected-product {
      min-height: 80px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px dashed rgba(142, 245, 142, 0.3);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .selected-product:hover {
      border-color: #8ef58e;
      background: rgba(142, 245, 142, 0.1);
    }

    .selected-product.has-product {
      border-style: solid;
      background: rgba(142, 245, 142, 0.1);
    }

    .product-placeholder {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      color: rgba(255, 255, 255, 0.6);
    }

    .product-icon {
      font-size: 24px;
      opacity: 0.7;
    }

    .product-text {
      font-size: 14px;
    }

    .product-select-btn {
      background: linear-gradient(135deg, #8ef58e, #ffd369);
      color: #1a1a1a;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: all 0.3s ease;
    }

    .product-select-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(142, 245, 142, 0.3);
    }

    .btn-arrow {
      font-size: 16px;
      font-weight: bold;
    }

    .required {
      color: #ff6b6b;
      font-weight: 600;
    }

    /* Modal sélection de produit */
    .product-selection-content {
      height: 100%;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .product-selection-card {
      background: linear-gradient(135deg, #6a4c93, #9b59b6, #8e44ad);
      border-radius: 16px;
      padding: 16px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 12px;
      box-shadow: 0 4px 15px rgba(106, 76, 147, 0.2);
      position: relative;
      overflow: hidden;
    }

    .product-selection-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent, rgba(255, 211, 105, 0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .product-selection-card:hover::before {
      opacity: 1;
    }

    .product-selection-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 35px rgba(106, 76, 147, 0.4);
      border-color: #ffd369;
    }

    .product-selection-card-content {
      display: flex;
      flex-direction: column;
      gap: 8px;
      position: relative;
      z-index: 1;
      height: 100%;
    }

    .product-selection-title {
      color: #ffffff;
      font-size: 14px;
      margin: 0;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      line-height: 1.2;
    }

    .product-selection-bottom {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-top: auto;
    }

    .product-selection-image {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      overflow: hidden;
      flex-shrink: 0;
      border: 2px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .product-selection-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .product-selection-right {
      display: flex;
      flex-direction: column;
      gap: 6px;
      flex: 1;
      align-items: flex-end;
    }

    .product-selection-price {
      color: #ffd369;
      font-size: 13px;
      font-weight: 900;
      margin: 0;
      background: rgba(255, 211, 105, 0.2);
      padding: 2px 8px;
      border-radius: 12px;
      border: 1px solid rgba(255, 211, 105, 0.3);
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
      white-space: nowrap;
    }

    .product-selection-category {
      color: rgba(255, 255, 255, 0.8);
      font-size: 10px;
      margin: 0;
      background: rgba(255, 255, 255, 0.1);
      padding: 2px 6px;
      border-radius: 8px;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100px;
    }

    /* Produit sélectionné */
    .selected-product-info {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px;
    }

    .selected-product-image {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      object-fit: cover;
    }

    .selected-product-details h4 {
      color: #8ef58e;
      margin: 0 0 4px 0;
      font-size: 14px;
    }

    .selected-product-details p {
      color: #ffd369;
      margin: 0 0 4px 0;
      font-size: 13px;
      font-weight: bold;
    }

    .selected-category {
      color: rgba(255, 255, 255, 0.7);
      font-size: 11px;
      background: rgba(255, 255, 255, 0.1);
      padding: 2px 6px;
      border-radius: 8px;
    }

    /* Upload de médias */
    .media-upload-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .media-upload-btn {
      background: linear-gradient(135deg, #6a4c93, #9b59b6);
      color: white;
      border: 2px dashed rgba(255, 255, 255, 0.3);
      padding: 16px 20px;
      border-radius: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .media-upload-btn:hover {
      background: linear-gradient(135deg, #7a5ba3, #ab69c6);
      border-color: #ffd369;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(106, 76, 147, 0.3);
    }

    .upload-icon {
      font-size: 20px;
    }

    .media-preview {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 8px;
      margin-top: 8px;
    }

    .media-preview-item {
      position: relative;
      width: 80px;
      height: 80px;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .media-preview-item img,
    .media-preview-item video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .media-preview-remove {
      position: absolute;
      top: 4px;
      right: 4px;
      background: rgba(255, 107, 107, 0.9);
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Médias dans les avis */
    .review-medias {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 8px;
      margin: 12px 0;
    }

    .review-media-item {
      width: 100%;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s ease;
      border: 2px solid rgba(255, 255, 255, 0.1);
    }

    .review-media-item:hover {
      transform: scale(1.05);
      border-color: #8ef58e;
    }

    /* Modale de sélection de médias */
    .media-modal-content {
      max-width: 800px;
      max-height: 90vh;
    }

    .media-selection-tabs {
      display: flex;
      gap: 0;
      margin-bottom: 20px;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.1);
    }

    .media-tab.active {
      background: linear-gradient(135deg, #6a4c93, #9b59b6);
      color: white;
      box-shadow: 0 4px 15px rgba(106, 76, 147, 0.3);
    }

    .media-tab:hover:not(.active) {
      background: rgba(255, 255, 255, 0.15);
      color: white;
    }

    .media-selection-content {
      min-height: 400px;
      margin-bottom: 20px;
    }

    .media-tab-content {
      display: none;
    }

    .media-tab-content.active {
      display: block;
    }

    .upload-drop-zone {
      border: 3px dashed rgba(255, 255, 255, 0.3);
      border-radius: 16px;
      padding: 40px 20px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
      background: linear-gradient(135deg, rgba(106, 76, 147, 0.1), rgba(155, 89, 182, 0.1));
    }

    .upload-drop-zone:hover,
    .upload-drop-zone.drag-over {
      border-color: #ffd369;
      background: linear-gradient(135deg, rgba(255, 211, 105, 0.1), rgba(106, 76, 147, 0.1));
      transform: translateY(-2px);
    }

    .upload-drop-content h3 {
      color: white;
      margin: 16px 0 8px 0;
      font-size: 18px;
    }

    .upload-drop-content p {
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 20px;
    }

    .upload-drop-icon {
      font-size: 48px;
      display: block;
      margin-bottom: 12px;
    }

    .browse-files-btn {
      background: linear-gradient(135deg, #6a4c93, #9b59b6);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .browse-files-btn:hover {
      background: linear-gradient(135deg, #7a5ba3, #ab69c6);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(106, 76, 147, 0.4);
    }

    .gallery-media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 12px;
      max-height: 300px;
      overflow-y: auto;
      padding: 8px;
    }

    .gallery-media-item {
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .gallery-media-item img,
    .gallery-media-item video {
      width: 100%;
      height: 120px;
      object-fit: cover;
    }

    .gallery-media-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .gallery-media-item.selected {
      border-color: #ffd369;
      box-shadow: 0 0 20px rgba(255, 211, 105, 0.5);
    }

    .gallery-media-item .selection-indicator {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .gallery-media-item.selected .selection-indicator {
      background: #ffd369;
      color: #000;
      font-weight: bold;
    }

    .selected-media-preview {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 8px;
      margin-top: 16px;
      padding: 16px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      min-height: 60px;
    }

    .selected-media-item {
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid rgba(255, 211, 105, 0.5);
    }

    .selected-media-item img,
    .selected-media-item video {
      width: 100%;
      height: 80px;
      object-fit: cover;
    }

    .selected-media-item .remove-selected {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: rgba(255, 107, 107, 0.9);
      color: white;
      border: none;
      cursor: pointer;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .media-selection-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 0;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .selected-count {
      color: rgba(255, 255, 255, 0.8);
      font-weight: 500;
    }

    .media-selection-actions {
      display: flex;
      gap: 12px;
    }

    .cancel-selection-btn {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .cancel-selection-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      color: white;
    }

    .validate-selection-btn {
      background: linear-gradient(135deg, #8ef58e, #4CAF50);
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .validate-selection-btn:hover {
      background: linear-gradient(135deg, #7de67d, #45a045);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
    }

    .validate-selection-btn:disabled {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.5);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Upload de médias */
    .media-upload-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .media-upload-btn {
      background: linear-gradient(135deg, #6a4c93, #9b59b6);
      color: white;
      border: 2px dashed rgba(255, 255, 255, 0.3);
      padding: 16px 20px;
      border-radius: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .media-upload-btn:hover {
      background: linear-gradient(135deg, #7a5ba3, #ab69c6);
      border-color: #ffd369;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(106, 76, 147, 0.3);
    }

    .upload-icon {
      font-size: 20px;
    }

    .media-preview {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 8px;
      margin-top: 8px;
    }

    .media-preview-item {
      position: relative;
      width: 80px;
      height: 80px;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .media-preview-item img,
    .media-preview-item video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .media-preview-remove {
      position: absolute;
      top: 4px;
      right: 4px;
      background: rgba(255, 107, 107, 0.9);
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .rating-star:hover,
    .rating-star.active {
      color: #ffd369;
    }

    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-family: inherit;
    }

    .form-group input::placeholder,
    .form-group textarea::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .rating-input {
      display: flex;
      gap: 4px;
      margin-bottom: 1rem;
    }

    .rating-star {
      font-size: 2em;
      color: rgba(255, 211, 105, 0.3);
      cursor: pointer;
      transition: color 0.2s;
    }

    .rating-star.active,
    .rating-star:hover {
      color: #ffd369;
    }

    .submit-review-btn {
      background: #8ef58e;
      color: #2e003e;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      font-size: 1em;
      transition: all 0.3s;
      width: 100%;
    }

    .submit-review-btn:hover {
      background: #7ae67a;
      transform: translateY(-2px);
    }

    /* Catégories: styles refondus */
    #category-modal.show {
      position: fixed;
      top: 0;
      left: 0;
      width: 360px;
      max-width: 100vw;
      height: 100vh;
      z-index: 1000;
      display: block;
      background: linear-gradient(to bottom right, #2e003e, #6a0572);
      box-shadow: 2px 0 12px rgba(0,0,0,0.4);
      border-right: 2px solid rgba(255, 211, 105, 0.3);
      animation: slideInLeft 0.25s ease-out;
    }

    @keyframes slideInLeft {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    #category-modal .modal-content { 
      padding: 18px; 
      background: linear-gradient(135deg, #2e003e, #6a0572); 
      color: white;
    }
    #category-modal .modal-header { border-bottom: 1px solid rgba(255, 211, 105, 0.2); padding-bottom: 10px; margin-bottom: 12px; }
    #category-modal .modal-title { font-size: 1.1rem; }
    #category-modal .close-btn { width: 30px; height: 30px; }

    .cat-breadcrumbs { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 10px; }
    .cat-crumb { background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); color:#ffd369; padding: 6px 10px; border-radius: 14px; cursor: pointer; font-size: 12px; }
    .cat-crumb.active { background: rgba(142,245,142,0.15); color:#8ef58e; border-color: rgba(142,245,142,0.3); }
    .cat-sep { color: rgba(255,255,255,0.5); align-self:center; }

    .cat-list { list-style: none; padding: 0; margin: 0; max-height: calc(100vh - 190px); overflow-y:auto; }
    .cat-item { display:flex; align-items:center; justify-content:space-between; gap:8px; padding:10px 8px; border-bottom: 1px solid rgba(255,255,255,0.08); }
    .cat-name { display:flex; align-items:center; gap:8px; color:#fff; font-weight:600; }
    .cat-children-count { color:#8ef58e; font-size: 12px; opacity:0.8; }
    .cat-actions { display:flex; gap:6px; }
    .cat-btn { background:#4b1a7f; color:#8ef58e; border:1px solid rgba(255,255,255,0.2); border-radius:6px; padding:6px 10px; cursor:pointer; font-size:12px; }
    .cat-btn.select { background:#8ef58e; color:#2e003e; border:none; }
    .cat-btn:hover { filter: brightness(1.1); }

    #category-modal .modal-title {
      color: #ffd369;
      font-size: 1.3em;
      font-weight: 600;
      margin: 0;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    #category-modal .close-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 211, 105, 0.3);
      color: #ffd369;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      font-size: 20px;
      transition: all 0.3s ease;
    }

    #category-modal .close-btn:hover {
      background: rgba(255, 211, 105, 0.2);
      color: #fff;
      transform: scale(1.1);
    }

    #category-modal .category-modal {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 15px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    #category-modal .category-tree {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #category-modal .category-item {
      list-style: none;
      margin: 0;
    }

    #category-modal .category-row {
      display: flex;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      transition: all 0.2s ease;
      border-radius: 6px;
      margin: 2px 0;
    }

    #category-modal .category-row:hover {
      background: rgba(255, 211, 105, 0.1);
      padding-left: 8px;
      box-shadow: 0 2px 8px rgba(255, 211, 105, 0.1);
    }

    #category-modal .category-children {
      list-style: none;
      padding: 0;
      margin: 0;
      overflow: hidden;
      transition: all 0.3s ease;
      border-left: 2px solid rgba(142, 245, 142, 0.2);
      margin-left: 15px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 0 8px 8px 0;
    }

    #category-modal .category-arrow {
      background: rgba(142, 245, 142, 0.1);
      border: 1px solid rgba(142, 245, 142, 0.3);
      color: #8ef58e;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      margin-right: 8px;
      font-size: 10px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #category-modal .category-arrow:hover {
      background: rgba(142, 245, 142, 0.2);
      transform: scale(1.1);
      box-shadow: 0 2px 6px rgba(142, 245, 142, 0.2);
    }

    #category-modal .category-name-btn {
      color: #fff;
      font-weight: 500;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-size: 0.95em;
      padding: 8px 12px;
      flex: 1;
      text-align: left;
      background: none;
      border: none;
      cursor: pointer;
    }

    #category-modal .category-name-btn:hover {
      background: rgba(255, 211, 105, 0.15);
      color: #ffd369;
      transform: translateX(3px);
    }

    /* Indentation progressive pour les niveaux profonds */
    #category-modal .category-item[data-level="0"] .category-name-btn {
      font-weight: 600;
      font-size: 1em;
    }

    #category-modal .category-item[data-level="1"] .category-name-btn {
      font-size: 0.95em;
      color: rgba(255, 255, 255, 0.9);
    }

    #category-modal .category-item[data-level="2"] .category-name-btn {
      font-size: 0.9em;
      color: rgba(255, 255, 255, 0.8);
    }

    #category-modal .category-item[data-level="3"] .category-name-btn {
      font-size: 0.85em;
      color: rgba(255, 255, 255, 0.7);
    }

    /* Animation de fermeture */
    #category-modal.hide {
      animation: slideOutLeft 0.3s ease-in forwards;
    }

    @keyframes slideOutLeft {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(-100%);
        opacity: 0;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ====== STYLES CARTES AVIS CLIENTS ====== */
    .review-card {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      border-radius: 16px;
      padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .review-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #ffd369, #8ef58e);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .review-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(255, 211, 105, 0.2);
      border-color: rgba(255, 211, 105, 0.3);
    }

    .review-card:hover::before {
      opacity: 1;
    }

    .review-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .review-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8ef58e, #ffd369);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: #2e003e;
      font-weight: bold;
      margin-right: 12px;
      box-shadow: 0 4px 12px rgba(142, 245, 142, 0.3);
    }

    .review-info {
      flex: 1;
    }

    .review-username {
      color: #ffd369;
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 4px 0;
    }

    .review-date {
      color: rgba(255, 255, 255, 0.7);
      font-size: 12px;
      margin: 0;
    }

    .review-verified {
      background: linear-gradient(135deg, #8ef58e, #4caf50);
      color: #2e003e;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: bold;
      text-transform: uppercase;
      box-shadow: 0 2px 6px rgba(142, 245, 142, 0.3);
    }

    .review-title {
      color: #fff;
      font-size: 18px;
      font-weight: 600;
      margin: 0 0 12px 0;
      line-height: 1.3;
    }

    .review-content {
      background: rgba(255, 255, 255, 0.08);
      border-left: 3px solid #ffd369;
      padding: 12px 15px;
      border-radius: 0 8px 8px 0;
      margin: 15px 0;
      position: relative;
    }

    .review-content::before {
      content: '"';
      position: absolute;
      top: -5px;
      left: 8px;
      font-size: 30px;
      color: #ffd369;
      opacity: 0.6;
    }

    .review-text {
      color: rgba(255, 255, 255, 0.9);
      font-style: italic;
      line-height: 1.5;
      margin: 0;
      font-size: 14px;
    }

    .review-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
    }

    .review-rating {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .review-stars {
      color: #ffd369;
      font-size: 16px;
      text-shadow: 0 2px 4px rgba(255, 211, 105, 0.3);
    }

    .review-rating-text {
      color: rgba(255, 255, 255, 0.8);
      font-size: 12px;
      font-weight: 500;
    }

    .review-product {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.8);
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 11px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Responsive pour les avis */
    @media (max-width: 768px) {
      .review-card {
        padding: 15px;
      }
      
      .review-avatar {
        width: 40px;
        height: 40px;
        font-size: 16px;
      }
      
      .review-title {
        font-size: 16px;
      }
    }

    /* ====== STYLES CARTES AVIS COMPACTES ====== */
    .review-card-compact {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      border-radius: 12px;
      padding: 16px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      min-height: 120px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .review-card-compact::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #ffd369, #8ef58e);
      opacity: 0;
      transition: opacity 0.3s ease;
      border-radius: 12px 12px 0 0;
    }

    .review-card-compact:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 211, 105, 0.15);
      border-color: rgba(255, 211, 105, 0.3);
    }

    .review-card-compact:hover::before {
      opacity: 1;
    }

    .review-rating-compact {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 8px;
    }

    .review-stars-compact {
      color: #ffd369;
      font-size: 16px;
      text-shadow: 0 1px 3px rgba(255, 211, 105, 0.3);
    }

    .review-rating-text-compact {
      color: rgba(255, 255, 255, 0.7);
      font-size: 12px;
      font-weight: 500;
    }

    .review-title-compact {
      color: #fff;
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 8px 0;
      line-height: 1.3;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .review-footer-compact {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: auto;
    }

    .review-user-compact {
      color: #8ef58e;
      font-size: 13px;
      font-weight: 500;
    }

    .review-date-compact {
      color: rgba(255, 255, 255, 0.6);
      font-size: 11px;
    }

    /* Modal détails avis */
    #review-detail-modal .modal-content {
      background: linear-gradient(135deg, 
        #1a0024 0%,
        #2d0040 25%, 
        #4b1a7f 50%,
        #8b2f97 75%,
        #c5447a 100%) !important;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px);
      border-radius: 0 !important;
      height: 100% !important;
      position: relative;
      overflow: hidden;
    }
    
    /* ::before supprimé pour éviter de cacher les coins */

    .review-detail-content {
      max-height: 70vh;
      overflow-y: auto;
      position: relative;
      z-index: 1;
    }

    .review-detail-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      padding: 20px;
      background: linear-gradient(135deg, 
        rgba(197, 68, 122, 0.12) 0%,
        rgba(139, 47, 151, 0.08) 50%,
        rgba(197, 68, 122, 0.04) 100%);
      border-radius: 15px;
      border: 1px solid rgba(197, 68, 122, 0.25);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    
    /* .review-detail-header::before supprimé pour éviter les problèmes de coins */

    .review-detail-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, 
        #c5447a 0%,
        #8b2f97 40%, 
        #4b1a7f 70%,
        #2d0040 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      color: #fff;
      font-weight: bold;
      margin-right: 20px;
      box-shadow: 0 8px 25px rgba(197, 68, 122, 0.35),
                  0 0 0 3px rgba(197, 68, 122, 0.2),
                  inset 0 2px 4px rgba(255, 255, 255, 0.15);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
      position: relative;
      transition: all 0.3s ease;
    }
    
    .review-detail-avatar::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, #c5447a, #8b2f97, #4b1a7f, #2d0040);
      border-radius: 50%;
      z-index: -1;
      animation: rotateGradient 3s linear infinite;
    }
    
    @keyframes rotateGradient {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .review-detail-info {
      flex: 1;
    }

    .review-detail-username {
      color: #ffd369;
      font-size: 18px;
      font-weight: 600;
      margin: 0 0 5px 0;
    }

    .review-detail-date {
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
      margin: 0;
    }

    .review-detail-rating {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 15px 0;
    }

    .review-detail-title {
      color: #fff;
      font-size: 22px;
      font-weight: 700;
      margin: 20px 0;
      text-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
      background: linear-gradient(135deg, #fff, #ff6b6b, #ffd369);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      position: relative;
    }

    .review-detail-description {
      background: linear-gradient(135deg, 
        rgba(197, 68, 122, 0.1) 0%,
        rgba(139, 47, 151, 0.06) 50%,
        rgba(75, 26, 127, 0.08) 100%);
      border-left: 4px solid #c5447a;
      border-radius: 0 15px 15px 0;
      padding: 20px 25px;
      margin: 25px 0;
      position: relative;
      backdrop-filter: blur(5px);
      box-shadow: 0 8px 20px rgba(197, 68, 122, 0.08),
                  inset 0 1px 0 rgba(255, 255, 255, 0.08);
    }

    /* .review-detail-description::before supprimé pour éviter les problèmes de coins */
    
    .review-detail-description::after {
      content: '"';
      position: absolute;
      bottom: -15px;
      right: 20px;
      font-size: 45px;
      color: #c5447a;
      opacity: 0.6;
      text-shadow: 0 2px 4px rgba(197, 68, 122, 0.25);
      font-family: 'Times New Roman', serif;
    }

    .review-detail-description p {
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.6;
      margin: 0;
      font-size: 16px;
    }

    .review-detail-product {
      background: rgba(255, 255, 255, 0.1);
      padding: 10px 15px;
      border-radius: 8px;
      margin: 15px 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .review-detail-product strong {
      color: #8ef58e;
    }

    .review-images-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .review-images-grid img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .review-images-grid img:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    /* Améliorations visuelles pour la modal avis */
    @keyframes modalSlideIn {
      0% { 
        opacity: 0; 
        transform: translateY(-30px) scale(0.9); 
      }
      100% { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
      }
    }
    
    #review-detail-modal.show .modal-content {
      animation: modalSlideIn 0.4s ease-out;
    }
    
    @keyframes starGlow {
      0% { 
        filter: drop-shadow(0 0 8px rgba(255, 211, 105, 0.6));
        transform: scale(1);
      }
      100% { 
        filter: drop-shadow(0 0 15px rgba(255, 211, 105, 0.8));
        transform: scale(1.05);
      }
    }
    
    .review-detail-rating .review-stars {
      font-size: 28px;
      color: #ffd369;
      animation: starGlow 2s ease-in-out infinite alternate;
    }
    
    @keyframes verifiedPulse {
      0% { 
        box-shadow: 0 4px 15px rgba(6, 214, 160, 0.4);
        transform: scale(1);
      }
      100% { 
        box-shadow: 0 6px 20px rgba(6, 214, 160, 0.6);
        transform: scale(1.02);
      }
    }
    
    /* Styles pour s'assurer que les médias ne débordent jamais des modales */
    .modal .main-image-container {
      max-width: 100% !important;
      overflow: hidden !important;
      text-align: center !important;
    }
    
    .modal .main-image, .modal #review-main-media, .modal #admin-review-main-media {
      max-width: 100% !important;
      height: auto !important;
      object-fit: contain !important;
      border-radius: 8px !important;
    }
    
    /* Styles pour les miniatures */
    .modal .thumbnail {
      max-width: 60px !important;
      max-height: 60px !important;
      object-fit: cover !important;
      border-radius: 4px !important;
    }
    
    .review-verified {
      background: linear-gradient(135deg, #06d6a0 0%, #118ab2 50%, #073b4c 100%);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.5px;
      border: 1px solid rgba(6, 214, 160, 0.5);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      animation: verifiedPulse 2s ease-in-out infinite alternate;
    }

    /* Modal détail avis */
    .review-detail-content {
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      padding: 20px 0;
    }

    .review-detail-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(142, 245, 142, 0.2);
    }

    .review-detail-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffd369, #8ef58e);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 18px;
      color: #1a1a1a;
      margin-right: 15px;
      flex-shrink: 0;
    }

    .review-detail-info {
      flex: 1;
    }

    .review-detail-username {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
      color: #8ef58e;
    }

    .review-detail-date {
      margin: 2px 0 0 0;
      font-size: 13px;
      color: rgba(255, 255, 255, 0.7);
    }

    .review-verified {
      background: linear-gradient(135deg, #8ef58e, #ffd369);
      color: #1a1a1a;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .review-detail-rating {
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .review-detail-rating .review-stars {
      font-size: 20px;
      color: #ffd369;
    }

    .review-detail-rating .review-rating-text {
      color: rgba(255, 255, 255, 0.8);
      font-size: 14px;
    }

    .review-detail-title {
      color: #8ef58e;
      font-size: 20px;
      margin: 0 0 15px 0;
      font-weight: 600;
    }

    .review-detail-description {
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.6;
      margin-bottom: 20px;
      font-size: 15px;
    }

    .review-detail-product {
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 20px;
      padding: 10px 15px;
      background: rgba(255, 211, 105, 0.1);
      border-radius: 8px;
      border-left: 3px solid #ffd369;
    }

    .review-detail-images h4 {
      color: #8ef58e;
      margin: 15px 0 10px 0;
      font-size: 16px;
    }

    .review-images-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .review-images-grid img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      border: 2px solid transparent;
    }

    .review-images-grid img:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(142, 245, 142, 0.3);
      border-color: #8ef58e;
    }

    @media (max-width: 768px) {
      .review-card-compact {
        padding: 12px;
        min-height: 100px;
      }
      
      .review-title-compact {
        font-size: 14px;
      }

      /* Responsive pour modal avis */
      .review-detail-content {
        max-height: 90vh;
        padding: 15px 0;
      }
      
      .review-detail-avatar {
        width: 40px;
        height: 40px;
        font-size: 16px;
      }
      
      .review-detail-username {
        font-size: 16px;
      }
      
      .review-detail-title {
        font-size: 18px;
      }
      
      .review-images-grid {
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      }
      
      .review-images-grid img {
        height: 100px;
      }
    }

    /* Scrollbars stylisées - pratiquement invisibles */
    ::-webkit-scrollbar {
      width: 4px;
      height: 4px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 211, 105, 0.2);
      border-radius: 2px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 211, 105, 0.4);
    }

    ::-webkit-scrollbar-corner {
      background: transparent;
    }

    /* Pour Firefox */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 211, 105, 0.2) transparent;
    }

    /* Styles améliorés pour les cartes d'arnaques */
    #products-grid-arnaques .product-card {
      position: relative;
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05));
      border: 2px solid rgba(255, 107, 107, 0.3);
      border-radius: 12px;
      transition: all 0.3s ease;
      overflow: hidden;
    }

    #products-grid-arnaques .product-card:hover {
      border-color: rgba(255, 107, 107, 0.6);
      box-shadow: 0 8px 25px rgba(255, 107, 107, 0.2);
      transform: translateY(-2px);
    }



    #products-grid-arnaques .product-card img {
      filter: saturate(0.8) contrast(1.1);
      transition: filter 0.3s ease;
    }

    #products-grid-arnaques .product-card:hover img {
      filter: saturate(1) contrast(1.2);
    }

    /* Modal arnaqueur stylisée */
    #arnaqueur-modal .modal-content {
      background: linear-gradient(135deg, #2e003e, #1a0026) !important;
      border: none;
      border-radius: 0 !important;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
      height: 100% !important;
    }

    #arnaqueur-modal .modal-content h2 {
      color: #ff6b6b;
      text-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
      border-bottom: 2px solid rgba(255, 107, 107, 0.3);
      padding-bottom: 12px;
      margin-bottom: 20px;
    }

    #arnaqueur-modal .modal-content p {
      background: rgba(255, 107, 107, 0.1);
      border-left: 4px solid #ff6b6b;
      padding: 12px 16px;
      border-radius: 8px;
      margin: 10px 0;
    }

    #arnaqueur-modal .modal-content strong {
      color: #ffd369;
      text-shadow: 0 1px 3px rgba(255, 211, 105, 0.3);
    }

    #arnaqueur-gallery img {
      border: 2px solid rgba(255, 107, 107, 0.3);
      border-radius: 8px;
      transition: all 0.3s ease;
      filter: saturate(0.9);
    }

    #arnaqueur-gallery img:hover {
      border-color: rgba(255, 107, 107, 0.8);
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
      filter: saturate(1.1);
      transform: scale(1.02);
    }

    /* Badge ARNAQUEUR stylisé */
    .product-status {
      background: linear-gradient(45deg, #ff6b6b, #e55555) !important;
      box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
      font-weight: bold;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      animation: pulse-warning 2s infinite;
    }

    @keyframes pulse-warning {
      0%, 100% { box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4); }
      50% { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.7); }
    }

    /* Icônes réseaux dans la modal */
    #arnaqueur-reseaux img {
      border-radius: 4px;
      transition: transform 0.2s ease;
    }

    #arnaqueur-reseaux img:hover {
      transform: scale(1.1);
    }

    /* Modal de filtre stylisée */
    #filter-modal .modal-content {
      background: linear-gradient(135deg, #2e004f 0%, #4b1a7f 70%, #3a0f5a 100%) !important;
      border: none;
      border-radius: 0 !important;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
      width: 100% !important;
      height: 100% !important;
      padding: 0;
      overflow: hidden;
      backdrop-filter: blur(8px);
    }

    #filter-modal .modal-header {
      background: linear-gradient(135deg, #4b1a7f 0%, #6a2a9f 50%, #5a247f 100%);
      color: #ffd369;
      padding: 20px 25px;
      margin: 0;
      font-weight: 600;
      border-bottom: 1px solid rgba(255, 211, 105, 0.2);
    }

    #filter-modal .modal-title {
      margin: 0;
      font-size: 1.3em;
      font-weight: 700;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    #filter-modal .close-btn {
      background: rgba(255, 211, 105, 0.2);
      color: #ffd369;
      border: none;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #filter-modal .close-btn:hover {
      background: rgba(255, 211, 105, 0.3);
      transform: rotate(90deg);
    }

    #filter-content {
      padding: 25px;
    }

    #filter-content .form-group {
      margin-bottom: 20px;
    }

    #filter-content label {
      display: block;
      color: #ffd369;
      font-weight: 500;
      margin-bottom: 8px;
      font-size: 1em;
    }

    #filter-content input[type="number"] {
      width: 100%;
      padding: 12px 15px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(142, 245, 142, 0.25);
      border-radius: 10px;
      color: #ffffff;
      font-size: 16px;
      transition: all 0.3s ease;
      backdrop-filter: blur(3px);
      box-sizing: border-box;
    }

    #filter-content input[type="number"]:focus {
      outline: none;
      border-color: rgba(142, 245, 142, 0.5);
      background: rgba(255, 255, 255, 0.12);
      box-shadow: 0 0 12px rgba(142, 245, 142, 0.25);
    }

    #filter-content input[type="number"]::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    #apply-filters {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #7de57d 0%, #8ef58e 50%, #6dd46d 100%);
      color: #2e004f;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 12px rgba(142, 245, 142, 0.25);
    }

    #apply-filters:hover {
      background: linear-gradient(135deg, #6dd46d 0%, #7de57d 50%, #5cc35c 100%);
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(142, 245, 142, 0.35);
    }

    #apply-filters:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(142, 245, 142, 0.3);
    }

    #filter-modal .icon-white {
      filter: invert(0.2) sepia(1) saturate(5) hue-rotate(240deg);
    }

    /* Bouton Commander Snapchat */
    #commander-btn:hover {
      background: linear-gradient(135deg, #7de57d, #5cc55c);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(142, 245, 142, 0.5);
    }

    #commander-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 10px rgba(142, 245, 142, 0.4);
    }
  </style>
</head>
<body>
  <!-- Top Banner Style Amazon -->
  <div class="top-banner">
    <div class="banner-left">
      <div class="banner-logo">
        <img src="img/_technique/icon/panier.png" alt="Panier" class="icon-white" style="width: 20px; height: 20px;">
        J'vend tout
      </div>
    </div>
    
    <div class="banner-nav">
      <button id="banner-articles"><img src="img/_technique/icon/produit.png" alt="Articles" class="icon-white"> <span>Articles</span></button>
      <button id="banner-offres"><img src="img/_technique/icon/offres.png" alt="Offres" class="icon-white"> <span>Offres</span></button>
      <button id="banner-arnaques"><img src="img/_technique/icon/arnaque.png" alt="Arnaques" class="icon-white"> <span>Arnaques</span></button>
      <button id="banner-preuves"><img src="img/_technique/icon/preuve.png" alt="Preuves" class="icon-white"> <span>Preuves</span></button>
    </div>
  </div>

  <!-- Menu hamburger (caché) -->
  <div class="hamburger" id="hamburger">
    <span></span>
    <span></span>
    <span></span>
  </div>

  <!-- Menu latéral (caché) -->
  <div class="sidebar" id="sidebar">
    <button id="menu-articles"><img src="img/_technique/icon/produit.png" alt="Articles" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Articles</button>
    <button id="menu-offres"><img src="img/_technique/icon/offres.png" alt="Offres" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Offres</button>
    <button id="menu-arnaques"><img src="img/_technique/icon/arnaque.png" alt="Arnaques" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Arnaques</button>
    <button id="menu-preuves"><img src="img/_technique/icon/preuve.png" alt="Preuves" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Preuves</button>
  </div>

  <div class="container">
    <!-- Menu horizontal (caché maintenant) -->
    <div class="menu-horizontal" id="menu-horizontal" style="display: none;">
      <button id="menu-articles-desktop"><img src="img/_technique/icon/produit.png" alt="Articles" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Articles</button>
      <button id="menu-offres-desktop"><img src="img/_technique/icon/offres.png" alt="Offres" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Offres</button>
      <button id="menu-arnaques-desktop"><img src="img/_technique/icon/arnaque.png" alt="Arnaques" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Arnaques</button>
      <button id="menu-preuves-desktop"><img src="img/_technique/icon/preuve.png" alt="Preuves" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Preuves</button>
    </div>

    <div class="main-content">
      <!-- Section Articles -->
      <div class="content-section active" id="articles-section">
        <div class="controls">
          <div class="search-container">
            <span class="search-icon"><img src="img/_technique/icon/loupe.png" alt="Rechercher" class="icon-white" style="width: 16px; height: 16px;"></span>
            <input type="text" id="search-input" placeholder="Rechercher un article...">
          </div>
          <button class="control-btn" id="category-button">
            <img src="img/_technique/icon/categorie.png" alt="Catégories" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Catégories
          </button>
          <div class="sort-dropdown">
            <button class="control-btn" id="sort-button">
              <img src="img/_technique/icon/trier.png" alt="Trier" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Trier <span class="dropdown-arrow">▼</span>
            </button>
            <div class="sort-options" id="sort-options-articles">
              <div class="sort-option active" data-sort="relevance">🎯 Pertinence</div>
              <div class="sort-option" data-sort="name-asc"><img src="img/_technique/icon/trie_AZ.png" alt="Nom ↓" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↓</div>
              <div class="sort-option" data-sort="name-desc"><img src="img/_technique/icon/trie_ZA.png" alt="Nom ↑" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↑</div>
              <div class="sort-option" data-sort="price-asc">💰 Prix ↑</div>
              <div class="sort-option" data-sort="price-desc">💰 Prix ↓</div>
            </div>
          </div>
          <button class="control-btn" id="filter-button">
            <img src="img/_technique/icon/filtre.png" alt="Filtres" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Filtres
          </button>
          <button class="control-btn" id="cart-button" style="display: flex; flex-direction: column; align-items: center; padding: 8px 12px; background: none; border: none; color: white; cursor: pointer;">
            <div style="position: relative; display: flex; align-items: center; margin-bottom: 4px;">
              <img src="img/_technique/icon/panier.png" alt="Panier" class="icon-white" style="width: 20px; height: 20px;">
              <span id="cart-count" style="margin-left: 4px; color: white; font-size: 14px; font-weight: normal;">0</span>
            </div>
            <span style="font-size: 12px; color: white;">Panier</span>
            <span id="cart-label" style="font-size: 11px; color: rgba(255,255,255,0.8); margin-top: 2px; display: none;"><span id="cart-total">0</span> €</span>
          </button>
        </div>
        <div class="products-grid" id="products-grid">
          <!-- Les produits seront chargés ici -->
        </div>
      </div>

      <!-- Section Offres -->
      <div class="content-section" id="offres-section">
        <div class="controls">
          <div class="search-container">
            <span class="search-icon"><img src="img/_technique/icon/loupe.png" alt="Rechercher" class="icon-white" style="width: 16px; height: 16px;"></span>
            <input type="text" id="search-input" placeholder="Rechercher une offre...">
          </div>
          <div class="sort-dropdown">
            <button class="control-btn" id="sort-button-offres">
              <img src="img/_technique/icon/trier.png" alt="Trier" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Trier <span class="dropdown-arrow">▼</span>
            </button>
            <div class="sort-options" id="sort-options-offres">
              <div class="sort-option active" data-sort="recent">📅 Récent</div>
              <div class="sort-option" data-sort="name-asc"><img src="img/_technique/icon/trie_AZ.png" alt="Nom ↓" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↓</div>
              <div class="sort-option" data-sort="name-desc"><img src="img/_technique/icon/trie_ZA.png" alt="Nom ↑" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↑</div>
              <div class="sort-option" data-sort="price-asc">💰 Prix ↑</div>
              <div class="sort-option" data-sort="price-desc">💰 Prix ↓</div>
              <div class="sort-option" data-sort="date-old">📅 Ancien</div>
            </div>
          </div>
          <button class="control-btn" id="category-button-offres">
            <img src="img/_technique/icon/categorie.png" alt="Catégories" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Catégories
          </button>
          <button class="control-btn" id="filter-button-offres">
            <img src="img/_technique/icon/filtre.png" alt="Filtres" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Filtres
          </button>
        </div>
        <div class="products-grid" id="products-grid-offres">
          <!-- Les offres seront chargées ici -->
        </div>
      </div>

      <!-- Section Arnaques -->
      <div class="content-section" id="arnaques-section">
        <div class="controls">
          <div class="search-container">
            <span class="search-icon"><img src="img/_technique/icon/loupe.png" alt="Rechercher" class="icon-white" style="width: 16px; height: 16px;"></span>
            <input type="text" id="search-input" placeholder="Rechercher un arnaqueur...">
          </div>
          <div class="sort-dropdown">
            <button class="control-btn" id="sort-button-arnaques">
              <img src="img/_technique/icon/trier.png" alt="Trier" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Trier <span class="dropdown-arrow">▼</span>
            </button>
            <div class="sort-options" id="sort-options-arnaques">
              <div class="sort-option active" data-sort="recent">📅 Récent</div>
              <div class="sort-option" data-sort="name-asc"><img src="img/_technique/icon/trie_AZ.png" alt="Nom ↓" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↓</div>
              <div class="sort-option" data-sort="name-desc"><img src="img/_technique/icon/trie_ZA.png" alt="Nom ↑" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↑</div>
              <div class="sort-option" data-sort="date-old">📅 Ancien</div>
            </div>
          </div>
          <button class="control-btn" id="category-button-arnaques">
            <img src="img/_technique/icon/categorie.png" alt="Catégories" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Catégories
          </button>
        </div>
        <div class="products-grid" id="products-grid-arnaques">
          <!-- Les arnaques seront chargées ici -->
        </div>
      </div>

      <!-- Section Preuves -->
      <div class="content-section" id="preuves-section">
        <div style="margin-bottom: 2rem;">
          <h2 style="color: #8ef58e; text-align: center;"><img src="img/_technique/icon/preuve.png" alt="Preuves" class="icon-white" style="width: 24px; height: 24px; vertical-align: middle; margin-right: 8px;"> Preuves de confiance</h2>
          <p style="text-align: center; color: #8ef58e;">Témoignages et preuves de la qualité de mes services</p>
          
          <!-- Compteur d'avis en attente de validation -->
          <div id="pending-admin-notice" class="pending-admin-notice" style="display: none;">
            <span id="pending-count-text"></span>
          </div>
          
          <div style="text-align: center; margin-top: 1rem;">
            <button id="add-review-btn" class="control-btn">
              ➕ Ajouter un avis
            </button>
          </div>
        </div>
        <div class="controls">
          <div class="search-container">
            <span class="search-icon"><img src="img/_technique/icon/loupe.png" alt="Rechercher" class="icon-white" style="width: 16px; height: 16px;"></span>
            <input type="text" id="search-input" placeholder="Rechercher une preuve...">
          </div>
          <div class="sort-dropdown">
            <button class="control-btn" id="sort-button-preuves">
              <img src="img/_technique/icon/trier.png" alt="Trier" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Trier <span class="dropdown-arrow">▼</span>
            </button>
            <div class="sort-options" id="sort-options-preuves">
              <div class="sort-option active" data-sort="relevance">🎯 Pertinence</div>
              <div class="sort-option" data-sort="name-asc"><img src="img/_technique/icon/trie_AZ.png" alt="Nom ↓" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↓</div>
              <div class="sort-option" data-sort="name-desc"><img src="img/_technique/icon/trie_ZA.png" alt="Nom ↑" class="icon-white" style="width: 14px; height: 14px; vertical-align: middle; margin-right: 5px;"> Nom ↑</div>
              <div class="sort-option" data-sort="date-desc">📅 Récent</div>
              <div class="sort-option" data-sort="rating-desc">⭐ Note</div>
            </div>
          </div>
          <button class="control-btn" id="category-button-preuves">
            <img src="img/_technique/icon/categorie.png" alt="Catégories" class="icon-white" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> Catégories
          </button>
        </div>
        <div class="products-grid" id="products-grid-preuves">
          <!-- Les preuves seront chargées ici -->
        </div>
      </div>
    </div>
  </div>

  <!-- Modal produit -->
  <div class="modal hidden" id="product-modal">
    <div class="modal-content">
      <span class="close">✖</span>
      <h2 id="modal-title"></h2>
      <p id="modal-description"></p>
      <img id="modal-img" style="max-width:100%; display:none;" />
      <video id="modal-video" controls style="max-width:100%; display:none;"></video>
    </div>
  </div>

  <!-- Modal panier -->
  <div class="modal hidden" id="cart-modal">
    <div class="modal-content cart-modal-content">
      <span class="close">✖</span>
      <div class="cart-main-content">
        <h2><img src="img/_technique/icon/panier.png" alt="Panier" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 8px;"> Votre panier</h2>
        <ul id="cart-list"></ul>
        <p style="margin-top: 1rem;"><strong>Total :</strong> <span id="cart-modal-total">0</span> €</p>
      </div>
      <button id="commander-btn" class="cart-commander-btn">
        <span>Commander sur Snapchat</span>
        <img src="img/_technique/icon/Snapchat.png" alt="Snapchat" width="24" height="24">
      </button>
    </div>
  </div>

  <!-- Modal Arnaqueur -->
  <div class="modal hidden" id="arnaqueur-modal">
    <div class="modal-content">
      <span class="close">✖</span>
      <h2 id="arnaqueur-modal-title"></h2>
      <div id="arnaqueur-modal-content">
        <div id="arnaqueur-info" style="margin-bottom: 20px;">
          <p><strong>Username :</strong> <span id="arnaqueur-username"></span></p>
          <p><strong>Réseaux :</strong> <span id="arnaqueur-reseaux"></span></p>
          <p><strong>Techniques :</strong> <span id="arnaqueur-techniques"></span></p>
        </div>
        <div id="arnaqueur-description" style="margin-bottom: 20px;"></div>
        <div id="arnaqueur-medias" style="display: none;">
          <h3>Preuves :</h3>
          <div id="arnaqueur-gallery"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal catégories (refonte) -->
  <div class="modal" id="category-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title"><img src="img/_technique/icon/categorie.png" alt="Catégories" class="icon-white" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 8px;"> Catégories</h3>
        <button class="close-btn" id="close-category-modal">&times;</button>
      </div>
      <div class="cat-breadcrumbs" id="cat-breadcrumbs"></div>
      <ul class="cat-list" id="cat-list"></ul>
    </div>
  </div>

  <!-- Modal filtres -->
  <div class="modal" id="filter-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title"><img src="img/_technique/icon/filtre.png" alt="Filtres" class="icon-white" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 8px;"> Filtres</h3>
        <button class="close-btn" id="close-filter-modal">&times;</button>
      </div>
      <div id="filter-content">
        <div class="form-group">
          <label>Prix minimum:</label>
          <input type="number" id="min-price" placeholder="0">
        </div>
        <div class="form-group">
          <label>Prix maximum:</label>
          <input type="number" id="max-price" placeholder="1000">
        </div>
        <div class="form-group">
          <button class="control-btn" id="apply-filters">Appliquer les filtres</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal ajout avis -->
  <div class="modal" id="add-review-modal">
    <div class="modal-content add-review-modal-content">
      <div class="modal-header add-review-header">
        <h3 class="modal-title add-review-title">
          <span class="title-icon">⭐</span>
          Ajouter un avis
        </h3>
        <button class="close-btn add-review-close" id="close-add-review-modal">&times;</button>
      </div>
      <form class="add-review-form" id="add-review-form">
        <div class="form-row">
          <div class="form-group half">
            <label for="review-client">Nom du client:</label>
            <input type="text" id="review-client" placeholder="Votre nom">
          </div>
          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="review-anonymous">
              <span class="checkmark"></span>
              Avis anonyme
            </label>
          </div>
        </div>
        
        <div class="form-group">
          <label for="review-produit">Produit : <span class="required">*</span></label>
          <div class="product-selector">
            <div class="selected-product" id="selected-product">
              <div class="product-placeholder">
                <span class="product-icon">📦</span>
                <span class="product-text">Cliquez pour sélectionner un produit</span>
              </div>
            </div>
            <button type="button" class="product-select-btn" id="product-select-btn">
              <span>Parcourir les produits</span>
              <span class="btn-arrow">→</span>
            </button>
          </div>
          <input type="hidden" id="review-produit" required>
        </div>
        
        <div class="form-group">
          <label for="review-titre">Titre de l'avis: <span class="optional">(optionnel)</span></label>
          <input type="text" id="review-titre" placeholder="Un titre pour votre avis...">
        </div>
        
        <div class="form-group">
          <label for="review-description">Votre témoignage: <span class="optional">(optionnel)</span></label>
          <textarea id="review-description" rows="4" placeholder="Partagez votre expérience avec nous..."></textarea>
        </div>
        
        <div class="form-group rating-group">
          <label>Note: <span class="rating-text">Très satisfait (5/5)</span></label>
          <div class="rating-input">
            <span class="rating-star" data-rating="1">⭐</span>
            <span class="rating-star" data-rating="2">⭐</span>
            <span class="rating-star" data-rating="3">⭐</span>
            <span class="rating-star" data-rating="4">⭐</span>
            <span class="rating-star" data-rating="5">⭐</span>
          </div>
        </div>
        
        <div class="form-group">
          <label>Photos/Vidéos: <span class="optional">(optionnel)</span></label>
          <div class="media-upload-section">
            <input type="file" id="review-media" multiple accept="image/*,video/*" style="display: none;">
            <button type="button" class="media-upload-btn" id="media-upload-btn">
              <span class="upload-icon">📷</span>
              <span>Sélectionner des médias</span>
            </button>
            <div class="media-preview" id="media-preview"></div>
          </div>
        </div>
        
        <button type="submit" class="submit-review-btn">
          <span class="btn-icon">📝</span>
          Envoyer mon avis
        </button>
      </form>
    </div>
  </div>

  <!-- Modal sélection de produit -->
  <div class="modal" id="product-selection-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">🛍️ Sélectionner un produit</h3>
        <button class="close-btn" id="close-product-selection-modal">&times;</button>
      </div>
      <div class="product-selection-content">
        <div class="search-container" style="margin-bottom: 20px;">
          <span class="search-icon"><img src="img/_technique/icon/loupe.png" alt="Rechercher" class="icon-white" style="width: 16px; height: 16px;"></span>
          <input type="text" id="search-input" placeholder="Rechercher un produit...">
        </div>
        <div class="products-grid" id="product-selection-grid">
          <!-- Les produits seront chargés ici -->
        </div>
      </div>
    </div>
  </div>

  <!-- Modal sélection de médias -->
  <div class="modal" id="media-selection-modal">
    <div class="modal-content media-modal-content">
      <div class="modal-header">
        <h3 class="modal-title">📷 Sélectionner des médias</h3>
        <button class="close-btn" id="close-media-selection-modal">&times;</button>
      </div>
    
      <div class="media-selection-content">
        <div class="media-tab-content active" id="device-tab">
          <div class="device-upload-area">
            <input type="file" id="device-media-input" multiple accept="image/*,video/*" style="display: none;">
            <div class="upload-drop-zone" id="upload-drop-zone">
              <div class="upload-drop-content">
                <span class="upload-drop-icon">📎</span>
                <h3>Glissez vos fichiers ici</h3>
                <p>ou cliquez pour parcourir</p>
              </div>
            </div>
          </div>
          <div class="selected-media-preview" id="device-selected-preview"></div>
        </div>
      </div>
      
      <div class="media-selection-footer">
        <div class="selected-count">
          <span id="selected-media-count">0 média sélectionné</span>
        </div>
        <div class="media-selection-actions">
          <button type="button" class="cancel-selection-btn" id="cancel-media-selection">
            Annuler
          </button>
          <button type="button" class="validate-selection-btn" id="validate-media-selection">
            <span class="btn-icon">✓</span>
            Valider la sélection
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal détails avis -->
  <div class="modal" id="review-detail-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title"><img src="img/_technique/icon/preuve.png" alt="Avis" class="icon-white" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 8px;"> Détail de l'avis</h3>
        <button class="close-btn" id="close-review-detail-modal">&times;</button>
      </div>
      <div class="review-detail-content">
        <div class="review-detail-header">
          <div class="review-detail-avatar" id="review-detail-avatar">C</div>
          <div class="review-detail-info">
            <h4 class="review-detail-username" id="review-detail-username">Client</h4>
            <p class="review-detail-date" id="review-detail-date">Date</p>
          </div>
          <div class="review-verified">VÉRIFIÉ</div>
        </div>
        
        <div class="review-detail-rating" id="review-detail-rating">
          <span class="review-stars">★★★★★</span>
          <span class="review-rating-text">(5/5)</span>
        </div>
        
        <h3 class="review-detail-title" id="review-detail-title">Titre de l'avis</h3>
        
        <div class="review-detail-description" id="review-detail-description">
          <p>Description de l'avis...</p>
        </div>
        
        <div class="review-detail-product" id="review-detail-product" style="display: none; cursor: pointer;" onclick="openProductFromReview()">
          <strong>Produit :</strong> <span id="review-product-name"></span>
        </div>
        
        <div class="review-detail-images" id="review-detail-images" style="display: none;">
          <h4 style="color: #8ef58e; margin: 15px 0 10px 0;">Photos :</h4>
          <div class="product-gallery">
            <div class="main-image-container" style="max-width: 100%; overflow: hidden; text-align: center;">
              <img id="review-main-image" class="main-image" src="" alt="Image principale" onclick="openImageModal(this.src)" style="max-width: 100%; height: auto; object-fit: contain; border-radius: 8px;">
            </div>
            <div class="thumbnail-container" id="review-thumbnails"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Variables globales
    let currentSection = 'articles';
    let articlesData = [];
    let offresData = [];
    let arnaquesData = [];
    let preuvesData = [];
  // categories est géré par la nouvelle modale de catégories plus bas
    let cart = [];
    let selectedRating = 5;

    // Fonction pour normaliser les chemins des médias
    function normalizeMediaPath(path) {
      if (!path) return '';
      if (path.startsWith('http')) return path;
      if (path.startsWith('img/')) return path;
      if (path.startsWith('/img/')) return path.substring(1); // Enlever le slash initial
      return 'img/' + path.replace(/^\//, ''); // Enlever le slash initial s'il existe
    }

    // Charger le compteur d'avis en attente
    async function loadPendingCountBadge() {
      try {
        const res = await fetch('/api/avis-pending');
        const avisPending = await res.json();
        const count = avisPending.length;
        
        const notice = document.getElementById('pending-admin-notice');
        const countText = document.getElementById('pending-count-text');
        
        if (count > 0 && notice && countText) {
          countText.textContent = `⚠️ ${count} avis en attente de validation par l'administrateur`;
          notice.style.display = 'block';
        } else if (notice) {
          notice.style.display = 'none';
        }
      } catch (e) {
        console.log('Pas d\'avis en attente ou erreur:', e.message);
        const notice = document.getElementById('pending-admin-notice');
        if (notice) notice.style.display = 'none';
      }
    }

    // Fonction de chargement des données selon la section
    async function loadSectionData() {
      console.log('loadSectionData appelée pour la section:', currentSection);
      try {
        switch(currentSection) {
          case 'articles':
            console.log('Chargement des articles...');
            const articlesRes = await fetch('/api/articles');
            console.log('Réponse articles:', articlesRes.status);
            articlesData = await articlesRes.json();
            console.log('Articles chargés:', articlesData.length);
            displayArticles(articlesData);
            // Charger les produits pour le formulaire d'avis après le chargement des articles
            loadProductsForReview();
            break;
          case 'offres':
            console.log('Chargement des offres...');
            if (!offresData.length) {
              const offresRes = await fetch('/offres.json');
              offresData = await offresRes.json();
            }
            displayOffres(offresData);
            break;
          case 'arnaques':
            console.log('Chargement des arnaques...');
            if (!arnaquesData.length) {
              const arnaquesRes = await fetch('/arnaques.json');
              arnaquesData = await arnaquesRes.json();
            }
            displayArnaques(arnaquesData);
            break;
          case 'preuves':
            console.log('Chargement des preuves...');
            const preuvesRes = await fetch('/api/preuves');
            preuvesData = await preuvesRes.json();
            displayPreuves(preuvesData);
            loadPendingCountBadge(); // Charger le compteur pour cette section
            break;
        }
      } catch (error) {
        console.error('Erreur lors du chargement des données:', error);
      }
    }

    // Fonction d'affichage des articles
    function displayArticles(articles) {
      console.log('displayArticles appelée avec:', articles.length, 'articles');
      const container = document.getElementById('products-grid');
      if (!container) {
        console.error('Container products-grid non trouvé');
        return;
      }
      
      container.innerHTML = '';
      
      articles.forEach(article => {
        const productDiv = document.createElement('div');
        productDiv.className = 'product-card';
        
        // Gérer les médias multiples (prendre le premier pour la card)
        let displayMedia = '';
        if (article.images && Array.isArray(article.images) && article.images.length > 0) {
          displayMedia = article.images[0];
        } else if (article.image) {
          displayMedia = article.image;
        }
        
        // Affichage média uniquement avec indicateur si plusieurs médias
        let mediaHtml = '';
        if (displayMedia) {
          const mediaCount = (article.images && Array.isArray(article.images)) ? article.images.length : 1;
          const indicator = mediaCount > 1 ? `<div style="position:absolute;top:5px;right:5px;background:rgba(0,0,0,0.7);color:white;padding:2px 6px;border-radius:4px;font-size:0.7em;">+${mediaCount}</div>` : '';
          
          if (displayMedia.endsWith('.mp4') || displayMedia.endsWith('.webm') || displayMedia.endsWith('.mov')) {
            mediaHtml = `
              <div style="position:relative;">
                <video src="${normalizeMediaPath(displayMedia)}" style="width:100%;height:100%;object-fit:cover;border-radius:8px;" muted></video>
                ${indicator}
              </div>
            `;
          } else {
            mediaHtml = `
              <div style="position:relative;">
                <img src="${normalizeMediaPath(displayMedia)}" alt="${article.nom}" style="width:100%;height:100%;object-fit:cover;border-radius:8px;">
                ${indicator}
              </div>
            `;
          }
        } else {
          productDiv.classList.add('no-image');
          mediaHtml = ``;
        }
        
        productDiv.innerHTML = `
          ${mediaHtml}
          <div class="product-info">
            <h3 class="product-name">${article.nom}</h3>
            <div class="product-footer">
              <span class="product-price">${article.prix}€</span>
              <button class="add-to-cart-btn" onclick="addToCart('${article.id}')">Ajouter</button>
            </div>
          </div>
        `;
        productDiv.addEventListener('click', (e) => {
          if (!e.target.classList.contains('add-to-cart-btn')) {
            showProductModal(article);
          }
        });
        container.appendChild(productDiv);
      });
    }

    // Fonction d'affichage des offres
    function displayOffres(offres) {
      const container = document.getElementById('products-grid-offres');
      if (!container) return;
      
      container.innerHTML = '';
      
      offres.forEach(offre => {
        const productDiv = document.createElement('div');
        productDiv.className = 'product-card';
        
        const mediaHtml = offre.image ? 
          `<img src="${normalizeMediaPath(offre.image)}" alt="${offre.name}" style="width:100%;height:120px;object-fit:contain;border-radius:8px;margin-bottom:12px;background:rgba(255,255,255,0.1);">` :
          (() => { productDiv.classList.add('no-image'); return ``; })();
        
        productDiv.innerHTML = `
          ${mediaHtml}
          <div class="product-info">
            <h3 class="product-name">${offre.name}</h3>
            <p class="product-description">${offre.description}</p>
            <div class="product-footer">
              <span class="product-price">${offre.price}€</span>
              <span class="product-status">OFFRE</span>
            </div>
          </div>
        `;
        
        productDiv.addEventListener('click', () => {
          showProductModal(offre);
        });
        
        container.appendChild(productDiv);
      });
    }

    // Fonction d'affichage des arnaques
    function displayArnaques(arnaques) {
      const container = document.getElementById('products-grid-arnaques');
      if (!container) return;
      
      container.innerHTML = '';
      
      arnaques.forEach(arnaque => {
        const productDiv = document.createElement('div');
        productDiv.className = 'product-card';
        
        const mediaHtml = arnaque.image ? 
          `<img src="${normalizeMediaPath(arnaque.image)}" alt="${arnaque.anonyme ? 'Arnaqueur anonyme' : (arnaque.nom || arnaque.username)}" style="width:100%;height:120px;object-fit:contain;border-radius:8px;margin-bottom:12px;background:rgba(255,255,255,0.1);">` :
          (() => { productDiv.classList.add('no-image'); return ``; })();
        
        productDiv.innerHTML = `
          ${mediaHtml}
          <div class="product-info">
            <h3 class="product-name" style="color:#ff6b6b; text-shadow: 0 1px 3px rgba(255, 107, 107, 0.3);">${arnaque.anonyme ? 'Arnaqueur anonyme' : (arnaque.nom || arnaque.username)}</h3>
            ${arnaque.username && arnaque.nom && !arnaque.anonyme ? `<div style="color:#8ef58e; font-size:0.9em; margin-top:2px; font-weight: 500;">@${arnaque.username}</div>` : ''}
            <p class="product-description" style="background: rgba(255, 107, 107, 0.1); padding: 8px 12px; border-radius: 6px; border-left: 3px solid #ff6b6b;">${arnaque.description || arnaque.techniques || 'Arnaqueur signalé'}</p>
            <div class="product-footer">
              <div style="background: rgba(142, 245, 142, 0.1); padding: 4px 8px; border-radius: 12px; display: flex; align-items: center; gap: 6px;">${(() => {
                if (!arnaque.reseaux || arnaque.reseaux === 'Réseaux non spécifiés') return '<span style="color:#8ef58e; font-size:0.8em;">Réseaux non spécifiés</span>';
                const reseauxList = Array.isArray(arnaque.reseaux) ? arnaque.reseaux : arnaque.reseaux.split(', ');
                const iconMap = {
                  'Snapchat': 'img/_technique/icon/Snapchat.png',
                  'Telegram': 'img/_technique/icon/telegram.png',
                  'Discord': 'img/_technique/icon/discord.ico',
                  'Instagram': 'img/_technique/icon/Instagram.png',
                  'Facebook': 'img/_technique/icon/facebook.png',
                  'WhatsApp': 'img/_technique/icon/whatsapp.png',
                  'Anonyme': 'img/_technique/icon/anonyme.png'
                };
                return reseauxList.map(reseau => {
                  const icon = iconMap[reseau.trim()] || '';
                  return icon ? `<img src="${icon}" alt="${reseau}" title="${reseau}" style="width: 16px; height: 16px;">` : `<span style="color:#8ef58e; font-size:0.7em;" title="${reseau}">${reseau}</span>`;
                }).join('');
              })()}</div>
            </div>
          </div>
        `;
        
        productDiv.addEventListener('click', () => {
          showArnaqueurModal(arnaque);
        });
        
        container.appendChild(productDiv);
      });
    }

    // Fonction pour afficher la modal détaillée d'un avis
    function showReviewModal(preuveData) {
      // Stocker les données de l'avis actuel pour la navigation
      currentReviewData = preuveData;
      const modal = document.getElementById('review-detail-modal');
      
      // Compatibilité ancien/nouveau format pour le nom utilisateur
      const username = preuveData.username || preuveData.client || 'Anonyme';
      const isAnonymous = preuveData.isAnonymous || username === 'Anonyme' || !username;
      
      // Pour l'affichage public, masquer le nom si anonyme
      const displayName = isAnonymous ? 'Anonyme' : username;
      
      // Remplir les détails - Avatar avec image pour anonymes
      const avatarElement = document.getElementById('review-detail-avatar');
      if (isAnonymous) {
        // Utiliser l'image anonyme pour les utilisateurs anonymes
        avatarElement.innerHTML = '<img src="img/_technique/icon/anonyme.png" alt="Utilisateur anonyme" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">';
      } else {
        // Utiliser l'initiale pour les utilisateurs identifiés
        avatarElement.textContent = username ? username.charAt(0).toUpperCase() : 'U';
      }
      
      document.getElementById('review-detail-username').textContent = displayName;
      
      // Formatage sécurisé de la date
      let formattedDate = 'Date non disponible';
      if (preuveData.date) {
        try {
          // Si c'est déjà au format français (dd/mm/yyyy)
          if (preuveData.date.includes('/')) {
            const [day, month, year] = preuveData.date.split('/');
            const dateObj = new Date(year, month - 1, day);
            if (!isNaN(dateObj.getTime())) {
              formattedDate = dateObj.toLocaleDateString('fr-FR', { 
                day: 'numeric', month: 'long', year: 'numeric' 
              });
            } else {
              formattedDate = preuveData.date;
            }
          } else {
            // Si c'est un timestamp ou format ISO
            const dateObj = new Date(preuveData.date);
            if (!isNaN(dateObj.getTime())) {
              formattedDate = dateObj.toLocaleDateString('fr-FR', { 
                day: 'numeric', month: 'long', year: 'numeric' 
              });
            } else {
              formattedDate = preuveData.date;
            }
          }
        } catch (e) {
          formattedDate = preuveData.date;
        }
      }
      
      document.getElementById('review-detail-date').textContent = formattedDate;
      
      // Rating
      const ratingContainer = document.getElementById('review-detail-rating');
      const stars = '★'.repeat(preuveData.rating) + '☆'.repeat(5 - preuveData.rating);
      ratingContainer.innerHTML = `
        <span class="review-stars">${stars}</span>
        <span class="review-rating-text">(${preuveData.rating}/5)</span>
      `;
      
      // Titre
      const titleElement = document.getElementById('review-detail-title');
      if (preuveData.titre) {
        titleElement.textContent = preuveData.titre;
        titleElement.style.display = 'block';
      } else {
        titleElement.style.display = 'none';
      }
      
      // Description - compatibilité ancien/nouveau format
      const commentaire = preuveData.commentaire || preuveData.description || 'Aucun commentaire';
      document.getElementById('review-detail-description').innerHTML = `<p>${commentaire}</p>`;
      
      // Produit concerné
      const productElement = document.getElementById('review-detail-product');
      const productNameElement = document.getElementById('review-product-name');
      if (preuveData.produit) {
        productNameElement.textContent = preuveData.produit;
        productElement.style.display = 'block';
      } else {
        productElement.style.display = 'none';
      }
      
      // Images/médias avec système de galerie avancé comme les produits
      const imagesContainer = document.getElementById('review-detail-images');
      const mainImage = document.getElementById('review-main-image');
      const thumbnailsContainer = document.getElementById('review-thumbnails');
      
      // Gérer les médias multiples - créer un tableau à partir de différents formats
      let mediaList = [];
      
      // Si on a un tableau 'medias' 
      if (preuveData.medias && Array.isArray(preuveData.medias)) {
        // Vérifier si c'est un format objet {type, path} ou des chaînes directes
        mediaList = preuveData.medias.map(media => {
          if (typeof media === 'string') {
            return media; // Chaîne directe
          } else if (media.path) {
            return media.path; // Format objet
          }
          return media;
        });
      }
      // Si on a un tableau d'images (format images simple) 
      else if (preuveData.images && Array.isArray(preuveData.images)) {
        mediaList = preuveData.images;
      }
      
      if (mediaList.length > 0) {
        // Normaliser les chemins
        mediaList = mediaList.map(path => normalizeMediaPath(path));
        
        // Afficher l'image/vidéo principale
        const firstMedia = mediaList[0];
        const mainContainer = document.querySelector('#review-detail-images .main-image-container');
        
        // Déterminer si c'est une vidéo ou une image
        if (firstMedia.includes('.mp4') || firstMedia.includes('.webm') || firstMedia.includes('.mov')) {
          mainContainer.innerHTML = `
            <video id="review-main-media" class="main-image" controls style="max-width: 100%; height: auto; object-fit: contain; border-radius: 8px;">
              <source src="${firstMedia}" type="video/mp4">
              Votre navigateur ne supporte pas la lecture vidéo.
            </video>
          `;
        } else {
          mainContainer.innerHTML = `
            <img id="review-main-media" class="main-image" src="${firstMedia}" alt="Image principale" onclick="openImageModal('${firstMedia}')" style="max-width: 100%; height: auto; object-fit: contain; border-radius: 8px;">
          `;
        }
        
        // Générer les miniatures avec support vidéo/image
        thumbnailsContainer.innerHTML = mediaList.map((mediaPath, index) => {
          const isVideo = mediaPath.includes('.mp4') || mediaPath.includes('.webm') || mediaPath.includes('.mov');
          const isActive = index === 0 ? 'active' : '';
          
          if (isVideo) {
            return `
              <div class="thumbnail ${isActive}" onclick="changeReviewMainMedia('${mediaPath}', this, 'video')" style="position: relative; cursor: pointer;">
                <video src="${mediaPath}" muted style="width: 60px; height: 60px; object-fit: cover; border-radius: 4px;"></video>
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 12px;">▶</div>
              </div>
            `;
          } else {
            return `
              <img src="${mediaPath}" class="thumbnail ${isActive}" onclick="changeReviewMainMedia('${mediaPath}', this, 'image')" alt="Miniature ${index + 1}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 4px; cursor: pointer;">
            `;
          }
        }).join('');
        
        imagesContainer.style.display = 'block';
      } else {
        imagesContainer.style.display = 'none';
      }
      
      // Afficher la modal
      openModal('review-detail-modal');
    }

    // Gestionnaire pour fermer la modal
    document.getElementById('close-review-detail-modal').addEventListener('click', function() {
      closeModal('review-detail-modal');
    });

    // Fermer en cliquant à côté
    document.getElementById('review-detail-modal').addEventListener('click', function(e) {
      if (e.target === this) {
        this.classList.remove('show');
      }
    });

    // Fonction pour changer le média principal dans la galerie des avis (images ET vidéos)
    function changeReviewMainMedia(mediaSrc, clickedThumbnail, mediaType) {
      const mainContainer = document.querySelector('#review-detail-images .main-image-container');
      const thumbnails = document.querySelectorAll('#review-thumbnails .thumbnail');
      
      // Changer le média principal selon le type
      if (mediaType === 'video') {
        mainContainer.innerHTML = `
          <video id="review-main-media" class="main-image" controls style="max-width: 100%; height: auto; object-fit: contain; border-radius: 8px;">
            <source src="${mediaSrc}" type="video/mp4">
            Votre navigateur ne supporte pas la lecture vidéo.
          </video>
        `;
      } else {
        mainContainer.innerHTML = `
          <img id="review-main-media" class="main-image" src="${mediaSrc}" alt="Image principale" onclick="openImageModal('${mediaSrc}')" style="max-width: 100%; height: auto; object-fit: contain; border-radius: 8px;">
        `;
      }
      
      // Mettre à jour l'état actif des miniatures
      thumbnails.forEach(thumb => thumb.classList.remove('active'));
      clickedThumbnail.classList.add('active');
    }

    // Garder l'ancienne fonction pour compatibilité
    function changeReviewMainImage(imageSrc, clickedThumbnail) {
      changeReviewMainMedia(imageSrc, clickedThumbnail, 'image');
    }

    // Variable globale pour stocker les données de l'avis actuel
    let currentReviewData = null;

    // Fonction pour ouvrir le produit depuis la modale d'avis
    function openProductFromReview() {
      if (!currentReviewData || !currentReviewData.produit) return;
      
      // Chercher le produit dans la liste des articles
      const article = articlesData.find(art => art.nom === currentReviewData.produit);
      if (article) {
        // Fermer la modale d'avis détaillée
        const reviewDetailModal = document.getElementById('review-detail-modal');
        if (reviewDetailModal) {
          reviewDetailModal.classList.remove('show');
        }
        // Ouvrir la modale du produit (API existante)
        showProductModal(article);
      }
    }

    // Fonction d'affichage des preuves (nouvelle interface)
    function displayPreuves(preuves) {
      const container = document.getElementById('products-grid-preuves');
      if (!container) return;
      
      container.innerHTML = '';
      
      if (!preuves || preuves.length === 0) {
        container.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; color: rgba(255,255,255,0.7); padding: 40px;">
            <img src="img/_technique/icon/preuve.png" alt="Aucun avis" class="icon-white" style="width: 48px; height: 48px; margin-bottom: 16px; opacity: 0.5;">
            <p>Aucun avis client pour le moment</p>
          </div>
        `;
        return;
      }
      
      preuves.forEach((preuve, index) => {
        const reviewCard = document.createElement('div');
        reviewCard.className = 'review-card-compact';
        
        // Générer les étoiles (5 par défaut)
        const rating = preuve.rating || 5;
        const stars = '★'.repeat(rating) + '☆'.repeat(5 - rating);
        
        // Gérer l'affichage du nom utilisateur (nouveau format) - masquer si anonyme
        const clientName = preuve.username || preuve.client || '';
        const isAnonymous = preuve.isAnonymous || !clientName || clientName.trim() === '' || clientName.toLowerCase() === 'anonyme';
        const displayName = isAnonymous ? '' : clientName; // Ne pas afficher le nom si anonyme
        
        // Formatage de la date
        const date = preuve.date || new Date().toLocaleDateString('fr-FR');
        
        // Créer le HTML de la carte compacte
        reviewCard.innerHTML = `
          <div class="review-rating-compact">
            <span class="review-stars-compact">${stars}</span>
            <span class="review-rating-text-compact">(${rating}/5)</span>
          </div>
          
          ${preuve.titre ? `<h3 class="review-title-compact">${preuve.titre}</h3>` : ''}
          
          <div class="review-footer-compact">
            ${displayName ? `<span class="review-user-compact">${displayName}</span>` : ''}
            <span class="review-date-compact">${date}</span>
          </div>
        `;
        
        // Animation d'apparition décalée
        reviewCard.style.animationDelay = `${index * 0.1}s`;
        reviewCard.style.animation = 'fadeInUp 0.6s ease forwards';
        
        // Ajouter l'événement de clic pour ouvrir la modal
        reviewCard.addEventListener('click', () => {
          showReviewModal(preuve);
        });
        
        container.appendChild(reviewCard);
      });
    }

    // --- MODALES ANCIENNES (static-index.html) ---
    let currentProduct = { name: '', price: 0, qty: 0 };
    const cartModal = document.getElementById('cart-modal');
    const cartList = document.getElementById('cart-list');
    const cartModalTotal = document.getElementById('cart-modal-total');
    function showProductModal(item) {
      const modal = document.getElementById('product-modal');
      const title = document.getElementById('modal-title');
      const description = document.getElementById('modal-description');
      const img = document.getElementById('modal-img');
      const video = document.getElementById('modal-video');
      
      // Remplir infos produit
      currentProduct = {
        name: item.nom || item.name || '',
        price: item.prix || item.price || 0,
        qty: cart.find(p => p.name === (item.nom || item.name))?.qty || 0
      };
      
      title.textContent = `${currentProduct.name} - ${currentProduct.price}€`;
      
      // Créer le HTML avec cart-controls AVANT la galerie
      let contentHtml = item.description || '';
      
      // Ajouter les contrôles panier en haut avec le style du site
      contentHtml += `
        <div id="cart-controls" style="margin: 15px 0; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.2); text-align: center;">
          <button id="remove-one" style="display:none; background: #ff6b6b; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 14px; margin-right: 8px; cursor: pointer;">
            <img src="img/_technique/icon/corebeille.png" alt="Supprimer" style="width: 14px; height: 14px;">
          </button>
          <span id="item-qty" style="display:none; background: #ffd369; color: #333; font-weight: bold; padding: 4px 12px; border-radius: 4px; margin: 0 8px;">x1</span>
          <button id="add-to-cart" style="background: #ffd369; color: #333; border: none; padding: 8px 16px; border-radius: 6px; font-weight: bold; cursor: pointer;">
            <img src="img/_technique/icon/panier.png" alt="Panier" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 6px;"> Ajouter
          </button>
        </div>
      `;
      
      // Gérer les médias multiples - créer un tableau à partir de différents formats
      let mediaList = [];
      
      // Si on a un tableau 'medias' avec {type, path} (nouveau format)
      if (item.medias && Array.isArray(item.medias)) {
        mediaList = item.medias.map(media => media.path);
        console.log('Format medias détecté:', item.medias);
      }
      // Si on a un tableau d'images (format images simple)
      else if (item.images && Array.isArray(item.images)) {
        mediaList = item.images;
        console.log('Format images détecté:', item.images);
      }
      // Sinon utiliser image/video/thumbnail séparément
      else {
        // Ajouter l'image principale si elle existe
        if (item.image && item.image.trim()) {
          mediaList.push(item.image);
        }
        
        // Ajouter la vidéo si elle existe  
        if (item.video && item.video.trim()) {
          mediaList.push(item.video);
        }
        
        // Ajouter le thumbnail si il existe et est différent des autres
        if (item.thumbnail && item.thumbnail.trim() && 
            !mediaList.includes(item.thumbnail)) {
          mediaList.push(item.thumbnail);
        }
        console.log('Format classique détecté, médias:', mediaList);
      }
      
      // Debug log temporaire
      console.log('Article:', item.nom, 'MediaList final:', mediaList);
      
      if (mediaList.length > 0) {
        contentHtml += '<div class="media-gallery">';
        
        // Média principal (le premier)
        const mainMedia = mediaList[0];
        const mainMediaPath = normalizeMediaPath(mainMedia);
        contentHtml += '<div class="main-media" id="main-media">';
        if (mainMedia.endsWith('.mp4') || mainMedia.endsWith('.webm') || mainMedia.endsWith('.mov')) {
          contentHtml += `
            <video src="${mainMediaPath}" controls preload="metadata" style="width: 100%; max-height: 300px; object-fit: contain; border-radius: 8px;">
              Votre navigateur ne supporte pas la vidéo.
            </video>
          `;
        } else {
          contentHtml += `
            <img src="${mainMediaPath}" alt="${currentProduct.name}" style="width: 100%; max-height: 300px; object-fit: contain; border-radius: 8px;" />
          `;
        }
        contentHtml += '</div>';
        
        // Miniatures des autres médias (s'il y en a plusieurs)
        if (mediaList.length > 1) {
          contentHtml += `
            <div class="media-thumbnails" style="margin-top: 20px; padding: 12px; background: rgba(255, 255, 255, 0.1); border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2);">
              <div style="margin-bottom: 10px; font-weight: 600; font-size: 15px; color: #fff; border-bottom: 1px solid rgba(255, 255, 255, 0.3); padding-bottom: 6px;">
                Voir tous les médias (${mediaList.length})
              </div>
              <div style="display: flex; gap: 8px; flex-wrap: wrap;">
          `;
          
          mediaList.forEach((mediaPath, index) => {
            const fullPath = normalizeMediaPath(mediaPath);
            const isActive = index === 0 ? 'active' : '';
            if (mediaPath.endsWith('.mp4') || mediaPath.endsWith('.webm') || mediaPath.endsWith('.mov')) {
              contentHtml += `
                <div class="media-thumb ${isActive}" data-media-index="${index}" data-media-path="${fullPath}" data-media-type="video" 
                     style="position: relative; width: 70px; height: 70px; border-radius: 6px; overflow: hidden; cursor: pointer; 
                            border: 2px solid ${index === 0 ? '#ffd369' : 'rgba(255, 255, 255, 0.4)'}; transition: all 0.2s ease; background: rgba(255, 255, 255, 0.1);">
                  <video src="${fullPath}" muted style="width: 100%; height: 100%; object-fit: cover;">
                  </video>
                  <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 14px; text-shadow: 1px 1px 2px rgba(0,0,0,0.7);">▶</div>
                </div>
              `;
            } else {
              contentHtml += `
                <div class="media-thumb ${isActive}" data-media-index="${index}" data-media-path="${fullPath}" data-media-type="image"
                     style="position: relative; width: 70px; height: 70px; border-radius: 6px; overflow: hidden; cursor: pointer; 
                            border: 2px solid ${index === 0 ? '#ffd369' : 'rgba(255, 255, 255, 0.4)'}; transition: all 0.2s ease; background: rgba(255, 255, 255, 0.1);">
                  <img src="${fullPath}" alt="Miniature ${index + 1}" style="width: 100%; height: 100%; object-fit: cover;" />
                  <div style="position: absolute; bottom: 2px; right: 2px; background: rgba(0,0,0,0.7); color: white; font-size: 9px; padding: 1px 3px; border-radius: 2px;">${index + 1}</div>
                </div>
              `;
            }
          });
          contentHtml += '</div></div>';
        }
        
        contentHtml += '</div>';
      }
      
      // Cacher les anciens éléments img/video
      img.style.display = 'none';
      video.style.display = 'none';
      
      // Injecter tout le contenu
      description.innerHTML = contentHtml;
      
      // Ajouter les event listeners pour les miniatures
      const thumbnails = description.querySelectorAll('.media-thumb');
      const mainMedia = description.querySelector('#main-media');
      
      console.log('Miniatures trouvées:', thumbnails.length, 'Élément main-media:', mainMedia);
      
      thumbnails.forEach((thumb, index) => {
        console.log('Ajout listener sur miniature', index, thumb.dataset);
        thumb.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          
          const mediaPath = thumb.dataset.mediaPath;
          const mediaType = thumb.dataset.mediaType;
          const mediaIndex = thumb.dataset.mediaIndex;
          
          console.log('Clic miniature:', { mediaPath, mediaType, mediaIndex });
          
          // Mettre à jour le média principal
          if (mediaType === 'video') {
            mainMedia.innerHTML = `
              <video src="${mediaPath}" controls preload="metadata" style="width: 100%; max-height: 300px; object-fit: contain; border-radius: 8px;">
                Votre navigateur ne supporte pas la vidéo.
              </video>
            `;
          } else {
            mainMedia.innerHTML = `
              <img src="${mediaPath}" alt="${currentProduct.name}" style="width: 100%; max-height: 300px; object-fit: contain; border-radius: 8px;" />
            `;
          }
          
          // Mettre à jour les bordures des miniatures
          thumbnails.forEach(t => t.style.border = '2px solid rgba(255, 255, 255, 0.4)');
          thumb.style.border = '2px solid #ffd369';
        });
        
        // Effet hover simple sur les miniatures
        thumb.addEventListener('mouseenter', () => {
          if (!thumb.style.border.includes('#ffd369')) {
            thumb.style.border = '2px solid rgba(255, 255, 255, 0.7)';
          }
        });
        
        thumb.addEventListener('mouseleave', () => {
          if (!thumb.style.border.includes('#ffd369')) {
            thumb.style.border = '2px solid rgba(255, 255, 255, 0.4)';
          }
        });
      });
      
      updateQtyDisplay();
      closeModal('cart-modal');
      openModal('product-modal');
    }
    function updateQtyDisplay() {
      const qtyDisplay = document.getElementById('item-qty');
      const removeOneBtn = document.getElementById('remove-one');
      if (!qtyDisplay || !removeOneBtn) return; // Vérifier que les éléments existent
      
      if (currentProduct.qty > 0) {
        qtyDisplay.style.display = 'inline';
        qtyDisplay.textContent = `x${currentProduct.qty}`;
        removeOneBtn.style.display = 'inline';
      } else {
        qtyDisplay.style.display = 'none';
        removeOneBtn.style.display = 'none';
      }
    }
    // Délégation d'événements pour les boutons créés dynamiquement
    document.addEventListener('click', (e) => {
      if (e.target.id === 'add-to-cart') {
        if (!currentProduct.name || isNaN(currentProduct.price)) return;
        let existing = cart.find(p => p.name === currentProduct.name);
        if (existing) {
          existing.qty += 1;
        } else {
          cart.push({ name: currentProduct.name, price: currentProduct.price, qty: 1 });
        }
        currentProduct.qty += 1;
        updateQtyDisplay();
        updateCartUI();
      } else if (e.target.id === 'remove-one') {
        if (!currentProduct.name) return;
        let existing = cart.find(p => p.name === currentProduct.name);
        if (existing && existing.qty > 1) {
          existing.qty -= 1;
          currentProduct.qty -= 1;
        } else if (existing && existing.qty === 1) {
          cart.splice(cart.indexOf(existing), 1);
          currentProduct.qty = 0;
        }
        updateQtyDisplay();
        updateCartUI();
      }
    });
    function updateCartUI() {
      let total = 0;
      let totalItems = 0;
      cart.forEach(item => { 
        total += item.price * item.qty; 
        totalItems += item.qty;
      });
      
      const totalSpan = document.getElementById('cart-total');
      const labelSpan = document.getElementById('cart-label');
      const countSpan = document.getElementById('cart-count');
      
      // Le compteur est toujours visible
      countSpan.textContent = totalItems;
      
      if (total === 0) {
        labelSpan.style.display = 'none';
      } else {
        totalSpan.textContent = total.toFixed(2);
        labelSpan.style.display = 'block';
      }
    }
    // Fermeture modale produit
    document.querySelector('#product-modal .close').addEventListener('click', () => {
      closeModal('product-modal');
    });
    // Fermeture modale panier
    document.querySelector('#cart-modal .close').addEventListener('click', () => {
      closeModal('cart-modal');
    });

    // Bouton Commander Snapchat
    document.getElementById('commander-btn')?.addEventListener('click', () => {
      const cartItems = cart.map(item => `${item.name} (x${item.quantity}) - ${item.price * item.quantity}€`).join('\n');
      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      const message = `🛒 Commande:\n${cartItems}\n\n💰 Total: ${total}€\n\nBonjour ! Je souhaite commander ces articles.`;
      const encodedMessage = encodeURIComponent(message);
      
      // Détection mobile pour Snapchat
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      const isMobile = /android|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent.toLowerCase());
      
      if (isMobile) {
        // Sur mobile, essayer d'ouvrir l'app Snapchat directement
        window.location.href = `snapchat://add/jvendtous`;
        // Fallback vers le navigateur si l'app n'est pas installée
        setTimeout(() => {
          window.open(`https://www.snapchat.com/add/jvendtous`, '_blank');
        }, 500);
      } else {
        // Sur desktop, ouvrir Snapchat web
        window.open(`https://www.snapchat.com/add/jvendtous`, '_blank');
      }
    });

    // Fermeture modale arnaqueur
    document.querySelector('#arnaqueur-modal .close').addEventListener('click', () => {
      closeModal('arnaqueur-modal');
    });

    // Fonction pour afficher la modale arnaqueur
    function showArnaqueurModal(arnaqueur) {
      const modal = document.getElementById('arnaqueur-modal');
      const title = document.getElementById('arnaqueur-modal-title');
      const username = document.getElementById('arnaqueur-username');
      const reseaux = document.getElementById('arnaqueur-reseaux');
      const techniques = document.getElementById('arnaqueur-techniques');
      const description = document.getElementById('arnaqueur-description');
      const mediasDiv = document.getElementById('arnaqueur-medias');
      const gallery = document.getElementById('arnaqueur-gallery');

      // Titre : soit le nom réel si disponible, soit "Arnaqueur anonyme"
      const displayName = arnaqueur.anonyme ? 'Arnaqueur anonyme' : (arnaqueur.nom && arnaqueur.nom.trim() ? arnaqueur.nom : 'Arnaqueur anonyme');
      title.textContent = displayName;

      // Informations
      username.textContent = arnaqueur.username || 'N/A';
      
      // Réseaux avec icônes
      if (arnaqueur.reseaux) {
        let reseauxHtml = '';
        const reseauxList = Array.isArray(arnaqueur.reseaux) ? arnaqueur.reseaux : arnaqueur.reseaux.split(', ');
        reseauxList.forEach(reseau => {
          const iconMap = {
            'Snapchat': 'img/_technique/icon/Snapchat.png',
            'Telegram': 'img/_technique/icon/telegram.png',
            'Discord': 'img/_technique/icon/discord.ico',
            'Instagram': 'img/_technique/icon/Instagram.png',
            'Facebook': 'img/_technique/icon/facebook.png',
            'WhatsApp': 'img/_technique/icon/whatsapp.png',
            'Anonyme': 'img/_technique/icon/anonyme.png'
          };
          const icon = iconMap[reseau.trim()] || '';
          if (icon) {
            reseauxHtml += `<img src="${icon}" alt="${reseau}" style="width: 24px; height: 24px; margin-right: 8px; vertical-align: middle;" title="${reseau}"> `;
          } else {
            reseauxHtml += `<span style="font-size: 0.9em; color: #ffd369; margin-right: 8px;" title="${reseau}">${reseau}</span> `;
          }
        });
        reseaux.innerHTML = reseauxHtml;
      } else {
        reseaux.textContent = 'N/A';
      }

      techniques.textContent = arnaqueur.techniques || 'N/A';
      description.innerHTML = arnaqueur.description || 'Aucune description disponible.';

      // Gérer les médias s'il y en a
      if (arnaqueur.medias && arnaqueur.medias.length > 0) {
        mediasDiv.style.display = 'block';
        gallery.innerHTML = '';
        arnaqueur.medias.forEach(media => {
          const mediaPath = normalizeMediaPath(media.path || media);
          const mediaElement = document.createElement('div');
          mediaElement.style.margin = '10px 0';
          
          if (mediaPath.endsWith('.mp4') || mediaPath.endsWith('.webm') || mediaPath.endsWith('.mov')) {
            mediaElement.innerHTML = `
              <video src="${mediaPath}" controls style="max-width: 100%; border-radius: 8px;">
                Votre navigateur ne supporte pas la vidéo.
              </video>
            `;
          } else {
            mediaElement.innerHTML = `
              <img src="${mediaPath}" alt="Preuve" style="max-width: 100%; border-radius: 8px;" />
            `;
          }
          gallery.appendChild(mediaElement);
        });
      } else {
        mediasDiv.style.display = 'none';
      }

      // Afficher la modale
      openModal('arnaqueur-modal');
    }
    // Affichage modale panier
    window.onload = () => {
      const cartButton = document.getElementById('cart-button');
      cartButton.addEventListener('click', () => {
        updateCartModal();
        closeModal('product-modal');
        openModal('cart-modal');
      });
      document.getElementById('cart-label').style.display = 'none';
    };
    function updateCartModal() {
      cartList.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        const li = document.createElement('li');
        const name = document.createElement('span');
        name.textContent = `${item.name} x${item.qty}`;
        const controls = document.createElement('div');
        controls.style.display = 'flex';
        controls.style.gap = '5px';
        const plus = document.createElement('button');
        plus.textContent = '+';
        plus.onclick = () => {
          item.qty += 1;
          updateCartUI();
          updateCartModal();
        };
        const minus = document.createElement('button');
        minus.textContent = '−';
        minus.onclick = () => {
          item.qty -= 1;
          if (item.qty <= 0) cart.splice(cart.indexOf(item), 1);
          updateCartUI();
          updateCartModal();
        };
        controls.appendChild(minus);
        controls.appendChild(plus);
        li.appendChild(name);
        li.appendChild(controls);
        cartList.appendChild(li);
        total += item.qty * item.price;
      });
      cartModalTotal.textContent = total.toFixed(2);
    }

    // Fonction pour ajouter au panier
    function addToCart(id) {
      console.log('Tentative d\'ajout au panier, ID:', id);
      console.log('Articles disponibles:', articlesData.map(a => ({id: a.id, nom: a.nom})));
      
      const article = articlesData.find(a => a.id === id);
      if (article) {
        // Vérifier si l'article existe déjà dans le panier
        const existingItem = cart.find(item => item.name === article.nom);
        if (existingItem) {
          // Augmenter la quantité
          existingItem.qty = (existingItem.qty || 1) + 1;
        } else {
          // Ajouter nouvel article avec quantité 1
          cart.push({
            name: article.nom,
            price: article.prix,
            qty: 1
          });
        }
        updateCartUI();
        console.log('Article ajouté au panier:', article.nom);
      } else {
        console.error('Article non trouvé avec l\'ID:', id);
        alert('Erreur : article non trouvé');
      }
    }

    // Augmenter/diminuer/supprimer du panier (style ancien)
    function increaseQuantity(name) {
      const item = cart.find(item => item.name === name);
      if (item) {
        item.qty = (item.qty || 1) + 1;
        updateCartUI();
        updateCartModal();
      }
    }

    function decreaseQuantity(name) {
      const item = cart.find(item => item.name === name);
      if (item && item.qty > 1) {
        item.qty--;
        updateCartUI();
        updateCartModal();
      } else if (item && item.qty === 1) {
        removeFromCart(name);
      }
    }

    function removeFromCart(name) {
      const index = cart.findIndex(item => item.name === name);
      if (index > -1) {
        cart.splice(index, 1);
        updateCartUI();
        updateCartModal();
      }
    }

    // Mettre à jour l'affichage du panier
    function updateCartDisplay() {
      const cartItems = document.getElementById('cart-items');
      const cartTotal = document.getElementById('cart-total');
      
      if (!cartItems || !cartTotal) return;
      
      cartItems.innerHTML = '';
      let total = 0;
      
      if (cart.length === 0) {
        cartItems.innerHTML = '<p style="text-align:center;color:#8ef58e;padding:2rem;">Votre panier est vide</p>';
      } else {
        cart.forEach((item) => {
          const quantity = item.quantity || 1;
          const itemTotal = (item.prix || 0) * quantity;
          total += itemTotal;
          
          const cartItem = document.createElement('div');
          cartItem.className = 'cart-item';
          cartItem.innerHTML = `
            <div class="cart-item-details">
              <span class="item-name">${item.nom}</span>
              <div class="item-pricing">
                <span class="unit-price">${item.prix}€/unité</span>
                <span class="total-price">${itemTotal}€</span>
              </div>
            </div>
            <div class="quantity-controls">
              <button class="qty-btn" onclick="decreaseQuantity('${item.id}')" ${quantity <= 1 ? 'disabled' : ''}>-</button>
              <span class="quantity">${quantity}</span>
              <button class="qty-btn" onclick="increaseQuantity('${item.id}')">+</button>
              <button class="remove-btn" onclick="removeFromCart('${item.id}')"><img src="img/_technique/icon/corebeille.png" alt="Supprimer" style="width: 14px; height: 14px;"></button>
            </div>
          `;
          cartItems.appendChild(cartItem);
        });
      }
      
      cartTotal.textContent = `Total: ${total}€`;
    }

    // Fonction de recherche et filtrage
    function applyFilters() {
      // Utiliser les données filtrées par catégorie si applicable
      let filteredData = getCurrentFilteredData();

      // Filtre par texte de recherche selon la section
      const searchInput = document.getElementById(`search-input${currentSection === 'articles' ? '' : '-' + currentSection}`);
      if (searchInput) {
        const searchText = searchInput.value.toLowerCase().trim();
        if (searchText) {
          if (currentSection === 'arnaques') {
            // Pour les arnaques, chercher dans nom et username
            filteredData = filteredData.filter(item => 
              (item.nom || '').toLowerCase().includes(searchText) || 
              (item.username || '').toLowerCase().includes(searchText) ||
              (item.description || '').toLowerCase().includes(searchText) ||
              (item.techniques || '').toLowerCase().includes(searchText)
            );
          } else {
            // Pour les autres sections, chercher dans nom et description
            filteredData = filteredData.filter(item => 
              (item.nom || item.name || item.titre || '').toLowerCase().includes(searchText) || 
              (item.description || '').toLowerCase().includes(searchText)
            );
          }
        }
      }

      // Filtres par prix (seulement pour articles et offres)
      if (currentSection === 'articles' || currentSection === 'offres') {
        const minPrice = parseFloat(document.getElementById('min-price')?.value) || 0;
        const maxPrice = parseFloat(document.getElementById('max-price')?.value) || Infinity;
        
        filteredData = filteredData.filter(item => {
          const price = item.prix || item.price || 0;
          return price >= minPrice && price <= maxPrice;
        });
      }

      // Afficher les résultats filtrés
      switch(currentSection) {
        case 'articles':
          displayArticles(filteredData);
          break;
        case 'offres':
          displayOffres(filteredData);
          break;
        case 'arnaques':
          displayArnaques(filteredData);
          break;
        case 'preuves':
          displayPreuves(filteredData);
          break;
      }
    }

    // Fonction de changement de section
    function showSection(sectionName) {
      // Masquer toutes les sections
      document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Retirer la classe active de tous les boutons
      document.querySelectorAll('#sidebar button, .menu-horizontal button, .banner-nav button').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Afficher la section demandée
      const targetSection = document.getElementById(sectionName + '-section');
      if (targetSection) {
        targetSection.classList.add('active');
        currentSection = sectionName;
        
        // Ajouter la classe active aux boutons correspondants
        document.querySelectorAll(`#menu-${sectionName}, #menu-${sectionName}-desktop, #banner-${sectionName}`).forEach(btn => {
          btn.classList.add('active');
        });
        
        // Réinitialiser les filtres
        window.currentCategoryFilter = null;
        
        // Charger les données de la section
        loadSectionData();
        
        // Fermer le menu mobile
        closeSidebar();
      }
    }

    // Système de gestion des modales (une seule ouverte à la fois par côté)
    const leftSideModals = []; // Plus de modales à gauche
    const rightSideModals = ['product-modal', 'cart-modal', 'arnaqueur-modal', 'category-modal', 'filter-modal', 'add-review-modal', 'product-selection-modal', 'review-detail-modal'];
    const specialModals = ['media-selection-modal']; // Peut rester ouverte avec d'autres

    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.remove('show');
        modal.classList.add('hidden');
      }
    }

    function openModal(modalId) {
      const modal = document.getElementById(modalId);
      if (!modal) return;

      // Ne pas fermer les autres modales si c'est une modal spéciale
      if (!specialModals.includes(modalId)) {
        // Déterminer le côté de la modal
        let isLeftSide = leftSideModals.includes(modalId);
        let isRightSide = rightSideModals.includes(modalId);

        // Fermer les autres modales du même côté
        if (isLeftSide) {
          leftSideModals.forEach(id => {
            if (id !== modalId) closeModal(id);
          });
        } else if (isRightSide) {
          rightSideModals.forEach(id => {
            if (id !== modalId) closeModal(id);
          });
        }
      }

      // Ouvrir la modal demandée
      modal.classList.remove('hidden');
      modal.classList.add('show');
    }

    // Fonctions pour le menu mobile
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('open');
    }

    function closeSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.remove('open');
    }

    // Fonction pour soumettre un avis
    async function submitReview(reviewData) {
      try {
        const response = await fetch('/api/avis-pending', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(reviewData)
        });
        
        if (response.ok) {
          alert('Votre avis a été soumis et sera examiné par un administrateur.');
          closeModal('add-review-modal');
          document.getElementById('add-review-form').reset();
          selectedRating = 5;
          updateStars();
          // Recharger le compteur d'avis en attente
          if (currentSection === 'preuves') {
            loadPendingCountBadge();
          }
        } else {
          alert('Erreur lors de la soumission de l\'avis. Veuillez réessayer.');
        }
      } catch (error) {
        console.error('Erreur:', error);
        alert('Erreur de connexion. Veuillez réessayer.');
      }
    }

    // Fonction pour mettre à jour l'affichage des étoiles
    function updateStars() {
      const stars = document.querySelectorAll('.rating-star');
      stars.forEach((star, index) => {
        if (index < selectedRating) {
          star.style.color = '#ffd369';
          star.classList.add('active');
        } else {
          star.style.color = 'rgba(255, 255, 255, 0.3)';
          star.classList.remove('active');
        }
      });
    }

    // Refonte: gestion des catégories avec navigation par niveaux
    let categories = [];
    let catNavStack = []; // chaque entrée: { name, children }

    async function loadCategories(section = 'articles') {
      try {
        const url = section === 'arnaques' ? '/api/categories-arnaques' : '/api/categories';
        const resp = await fetch(url);
        if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
        categories = await resp.json();
        catNavStack = [{ name: 'Toutes', children: categories }];
        openCategoryModal();
        renderCategoryLevel();
      } catch (e) {
        console.error('Erreur catégories:', e);
        alert('Erreur chargement catégories: ' + e.message);
      }
    }

    function openCategoryModal() {
      openModal('category-modal');
    }

    function closeCategoryModal() {
      closeModal('category-modal');
    }

    // Rendu du niveau courant + breadcrumbs
    function renderCategoryLevel() {
      const crumbs = document.getElementById('cat-breadcrumbs');
      const list = document.getElementById('cat-list');
      if (!crumbs || !list) return;

      // Breadcrumbs
      crumbs.innerHTML = '';
      catNavStack.forEach((node, idx) => {
        const crumb = document.createElement('span');
        crumb.className = 'cat-crumb' + (idx === catNavStack.length - 1 ? ' active' : '');
        crumb.textContent = node.name;
        crumb.addEventListener('click', () => {
          if (idx < catNavStack.length - 1) {
            catNavStack = catNavStack.slice(0, idx + 1);
            renderCategoryLevel();
          }
        });
        crumbs.appendChild(crumb);
        if (idx < catNavStack.length - 1) {
          const sep = document.createElement('span');
          sep.className = 'cat-sep';
          sep.textContent = '›';
          crumbs.appendChild(sep);
        }
      });

      // Liste
      list.innerHTML = '';
      const current = catNavStack[catNavStack.length - 1];
      (current.children || []).forEach(child => {
        const li = document.createElement('li');
        li.className = 'cat-item';
        const name = document.createElement('div');
        name.className = 'cat-name';
        name.innerHTML = `<span>📁</span><span>${child.name}</span>`;
        const actions = document.createElement('div');
        actions.className = 'cat-actions';

        const hasChildren = child.children && child.children.length > 0;
        if (hasChildren) {
          const openBtn = document.createElement('button');
          openBtn.className = 'cat-btn';
          openBtn.textContent = 'Ouvrir';
          openBtn.addEventListener('click', () => {
            catNavStack.push({ name: child.name, children: child.children });
            renderCategoryLevel();
          });
          actions.appendChild(openBtn);
        }

        const selectBtn = document.createElement('button');
        selectBtn.className = 'cat-btn select';
        selectBtn.textContent = 'Choisir';
        selectBtn.addEventListener('click', () => {
          // Construire le chemin complet sélectionné
          const fullPath = catNavStack
            .map(n => n.name)
            .filter(n => n !== 'Toutes')
            .concat(child.name)
            .join('/');
          filterByCategory(child.name, fullPath.split('/'));
          closeCategoryModal();
        });
        actions.appendChild(selectBtn);

        li.appendChild(name);
        li.appendChild(actions);
        list.appendChild(li);
      });
    }

    // Charger les produits pour le formulaire d'avis
    function loadProductsForReview() {
      // Ancienne implémentation supprimée: le champ #review-produit est un input hidden.
      // La sélection de produit se fait via la modale "product-selection-modal" et la fonction selectProduct().
      return;
    }

    // Filtrer par catégorie
  function filterByCategory(categoryName, fullPath = null) {
      console.log('🏷️ Filtrage par catégorie:', categoryName);
      console.log('🗺️ Chemin complet:', fullPath);
      
      // Mettre à jour le titre de la section
  const sectionEl = document.getElementById(`${currentSection}-section`);
  const sectionTitle = sectionEl ? sectionEl.querySelector('h2') : null;
      if (sectionTitle) {
  const displayPath = Array.isArray(fullPath) ? fullPath.join(' > ') : categoryName;
  sectionTitle.textContent = `${currentSection.charAt(0).toUpperCase() + currentSection.slice(1)} - ${displayPath}`;
      }
      
      // Construire le chemin de catégorie attendu
      let targetPath = '';
      if (fullPath && Array.isArray(fullPath)) {
        targetPath = fullPath.join('/');
      } else {
        targetPath = categoryName;
      }
      
      console.log('🎯 Chemin cible:', targetPath);
      
      // Filtrer les articles par catégorie EXACTE
      const filteredArticles = articlesData.filter(article => {
        if (!article.categorie) return false;
        
        // Correspondance exacte du chemin complet
        const isExactMatch = article.categorie === targetPath;
        
        // Correspondance si l'article est dans une sous-catégorie du chemin ciblé
        const isInSubcategory = article.categorie.startsWith(targetPath + '/');
        
        console.log(`📄 Article "${article.nom}": catégorie="${article.categorie}", cible="${targetPath}", exacte=${isExactMatch}, sous-cat=${isInSubcategory}`);
        
        return isExactMatch || isInSubcategory;
      });
      
      console.log(`🔍 ${filteredArticles.length} articles trouvés dans la catégorie "${targetPath}"`);
      
      // Afficher les articles filtrés
      displayArticles(filteredArticles);
      
      // Sauvegarder le filtre actuel
      window.currentCategoryFilter = targetPath;
      window.currentCategoryPath = fullPath;
    }

    // Fonction pour réinitialiser les filtres et afficher tous les articles
    function clearCategoryFilter() {
      console.log('🔄 Réinitialisation du filtre catégorie');
      
      // Réinitialiser le titre
  const sectionEl = document.getElementById(`${currentSection}-section`);
  const sectionTitle = sectionEl ? sectionEl.querySelector('h2') : null;
      if (sectionTitle) {
  sectionTitle.textContent = currentSection.charAt(0).toUpperCase() + currentSection.slice(1);
      }
      
      // Afficher tous les articles
      displayArticles(articlesData);
      
      // Supprimer le filtre actuel
      window.currentCategoryFilter = null;
      window.currentCategoryPath = null;
    }

    // Fonction pour obtenir les données de base selon la section courante
    function getBaseSectionData() {
      switch(currentSection) {
        case 'articles':
          return [...articlesData];
        case 'offres':
          return [...offresData];
        case 'arnaques':
          return [...arnaquesData];
        case 'preuves':
          return [...preuvesData];
        default:
          return [];
      }
    }

    // Fonction pour obtenir les données filtrées par catégorie si applicable
    function getCurrentFilteredData() {
      let data = getBaseSectionData();
      
      // Appliquer le filtre de catégorie si actif (uniquement pour les articles)
      if (currentSection === 'articles' && window.currentCategoryFilter) {
        data = data.filter(item => {
          if (!item.categorie) return false;
          
          // Recherche exacte par nom
          if (item.categorie === window.currentCategoryFilter) return true;
          
          // Recherche dans le chemin complet si disponible
          if (window.currentCategoryPath) {
            return window.currentCategoryPath.some(pathPart => 
              item.categorie.includes(pathPart) || 
              pathPart.includes(item.categorie)
            );
          }
          
          // Recherche par inclusion partielle
          return item.categorie.includes(window.currentCategoryFilter) || 
                 window.currentCategoryFilter.includes(item.categorie);
        });
      }
      
      return data;
    }

    // Initialisation au chargement de la page
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOMContentLoaded - Initialisation...');
      
      // Gestion du menu hamburger
      const hamburger = document.getElementById('hamburger');
      const sidebar = document.getElementById('sidebar');
      
      hamburger.addEventListener('click', toggleSidebar);
      
      // Gestion des boutons de menu (mobile)
      document.getElementById('menu-articles')?.addEventListener('click', () => showSection('articles'));
      document.getElementById('menu-offres')?.addEventListener('click', () => showSection('offres'));
      document.getElementById('menu-arnaques')?.addEventListener('click', () => showSection('arnaques'));
      document.getElementById('menu-preuves')?.addEventListener('click', () => showSection('preuves'));
      
      // Gestion des boutons de menu (desktop)
      document.getElementById('menu-articles-desktop')?.addEventListener('click', () => showSection('articles'));
      document.getElementById('menu-offres-desktop')?.addEventListener('click', () => showSection('offres'));
      document.getElementById('menu-arnaques-desktop')?.addEventListener('click', () => showSection('arnaques'));
      document.getElementById('menu-preuves-desktop')?.addEventListener('click', () => showSection('preuves'));
      
      // Gestion des nouveaux boutons du banner
      document.getElementById('banner-articles')?.addEventListener('click', () => showSection('articles'));
      document.getElementById('banner-offres')?.addEventListener('click', () => showSection('offres'));
      document.getElementById('banner-arnaques')?.addEventListener('click', () => showSection('arnaques'));
      document.getElementById('banner-preuves')?.addEventListener('click', () => showSection('preuves'));
      
      // Gestion des boutons de contrôle
      // Gestion des boutons de catégories pour toutes les sections
      document.getElementById('category-button').addEventListener('click', () => {
        console.log('🖱️ Clic sur le bouton catégories Articles');
        loadCategories('articles');
      });
      
      // Ajouter event listeners pour les autres boutons de catégories s'ils existent
      const categoryBtnOffres = document.getElementById('category-button-offres');
      if (categoryBtnOffres) {
        categoryBtnOffres.addEventListener('click', () => {
          console.log('🖱️ Clic sur le bouton catégories Offres');
          loadCategories('offres'); // Utilise les mêmes catégories qu'Articles
        });
      }
      
      const categoryBtnArnaques = document.getElementById('category-button-arnaques');
      if (categoryBtnArnaques) {
        categoryBtnArnaques.addEventListener('click', () => {
          console.log('🖱️ Clic sur le bouton catégories Arnaques');
          loadCategories('arnaques');
        });
      }
      
      const categoryBtnPreuves = document.getElementById('category-button-preuves');
      if (categoryBtnPreuves) {
        categoryBtnPreuves.addEventListener('click', () => {
          console.log('🖱️ Clic sur le bouton catégories Preuves');
          loadCategories('preuves'); // Utilise les mêmes catégories qu'Articles
        });
      }

      // Bouton de fermeture de la modal catégories (nouvelle implémentation)
      const closeCatBtn = document.getElementById('close-category-modal');
      if (closeCatBtn) closeCatBtn.addEventListener('click', () => {
        closeModal('category-modal');
      });
      
      // Gestion des dropdowns de tri
      function initSortDropdowns() {
        // Pour chaque dropdown de tri
        document.querySelectorAll('.sort-dropdown').forEach(dropdown => {
          const button = dropdown.querySelector('.control-btn');
          const options = dropdown.querySelector('.sort-options');
          
          // Toggle dropdown
          button.addEventListener('click', (e) => {
            e.stopPropagation();
            // Fermer les autres dropdowns
            document.querySelectorAll('.sort-dropdown').forEach(other => {
              if (other !== dropdown) other.classList.remove('active');
            });
            dropdown.classList.toggle('active');
          });
          
          // Gérer les options de tri
          options.querySelectorAll('.sort-option').forEach(option => {
            option.addEventListener('click', (e) => {
              e.stopPropagation();
              
              // Marquer comme actif
              options.querySelectorAll('.sort-option').forEach(opt => opt.classList.remove('active'));
              option.classList.add('active');
              
              // Exécuter le tri
              const sortType = option.dataset.sort;
              const section = dropdown.closest('.content-section').id.replace('-section', '');
              applySorting(section, sortType);
              
              // Fermer le dropdown
              dropdown.classList.remove('active');
            });
          });
        });
        
        // Fermer dropdowns au clic extérieur
        document.addEventListener('click', () => {
          document.querySelectorAll('.sort-dropdown').forEach(dropdown => {
            dropdown.classList.remove('active');
          });
        });
      }
      
      // Appliquer le tri selon la section et le type
      function applySorting(section, sortType) {
        console.log(`🔄 Tri ${section} par ${sortType}`);
        
        // Utiliser les données filtrées par catégorie si applicable
        let dataToSort = getCurrentFilteredData();
        let displayFunction;
        
        switch(section) {
          case 'articles':
            displayFunction = displayArticles;
            break;
          case 'offres':
            displayFunction = displayOffres;
            break;
          case 'arnaques':
            displayFunction = displayArnaques;
            break;
          case 'preuves':
            displayFunction = displayPreuves;
            break;
          default:
            return;
        }
        
        // Tri selon le type
        switch(sortType) {
          case 'relevance':
            // Tri par pertinence (ordre original)
            break;
          case 'name-asc':
            dataToSort.sort((a, b) => {
              const nameA = a.nom || a.name || a.username || '';
              const nameB = b.nom || b.name || b.username || '';
              return nameA.localeCompare(nameB);
            });
            break;
          case 'name-desc':
            dataToSort.sort((a, b) => {
              const nameA = a.nom || a.name || a.username || '';
              const nameB = b.nom || b.name || b.username || '';
              return nameB.localeCompare(nameA);
            });
            break;
          case 'price-asc':
            dataToSort.sort((a, b) => (a.prix || a.price || 0) - (b.prix || b.price || 0));
            break;
          case 'price-desc':
            dataToSort.sort((a, b) => (b.prix || b.price || 0) - (a.prix || a.price || 0));
            break;
          case 'recent':
            dataToSort.sort((a, b) => {
              const dateA = new Date(a.date || a.dateAjout || 0);
              const dateB = new Date(b.date || b.dateAjout || 0);
              return dateB - dateA;
            });
            break;
          case 'date-old':
            dataToSort.sort((a, b) => {
              const dateA = new Date(a.date || a.dateAjout || 0);
              const dateB = new Date(b.date || b.dateAjout || 0);
              return dateA - dateB;
            });
            break;
          case 'date-desc':
            dataToSort.sort((a, b) => {
              const dateA = new Date(a.date || a.dateAjout || 0);
              const dateB = new Date(b.date || b.dateAjout || 0);
              return dateB - dateA;
            });
            break;
          case 'rating-desc':
            dataToSort.sort((a, b) => (b.rating || 5) - (a.rating || 5));
            break;
        }
        
        displayFunction(dataToSort);
      }
      
      // Gestion des filtres
      document.getElementById('filter-button').addEventListener('click', () => {
        openModal('filter-modal');
      });
      
      // Bouton panier avec style ancien
      document.getElementById('cart-button').addEventListener('click', () => {
        updateCartModal();
        closeModal('product-modal');
        openModal('cart-modal');
      });
      
      // Bouton d'ajout d'avis
      const addReviewBtn = document.getElementById('add-review-btn');
      if (addReviewBtn) {
        addReviewBtn.addEventListener('click', () => {
          openModal('add-review-modal');
        });
      }
      
      // Gestion des recherches
      document.getElementById('search-input').addEventListener('input', applyFilters);
      document.getElementById('search-input').addEventListener('input', applyFilters);
      document.getElementById('search-input').addEventListener('input', applyFilters);
  const searchPreuves = document.getElementById('search-input');
  if (searchPreuves) searchPreuves.addEventListener('input', applyFilters);
      
      // Gestion des filtres
      const applyFiltersBtn = document.getElementById('apply-filters');
      if (applyFiltersBtn) {
        applyFiltersBtn.addEventListener('click', () => {
          applyFilters();
          closeModal('filter-modal');
        });
      }
      const closeFilterModalBtn = document.getElementById('close-filter-modal');
      if (closeFilterModalBtn) closeFilterModalBtn.addEventListener('click', () => closeModal('filter-modal'));
      const filterBtnOffres = document.getElementById('filter-button-offres');
      if (filterBtnOffres) filterBtnOffres.addEventListener('click', () => openModal('filter-modal'));
      const filterBtnPreuves = document.getElementById('filter-button-preuves');
      if (filterBtnPreuves) filterBtnPreuves.addEventListener('click', () => openModal('filter-modal'));
      
      // Gestion du sélecteur de produit
      const productSelectBtn = document.getElementById('product-select-btn');
      if (productSelectBtn) {
        productSelectBtn.addEventListener('click', () => {
          loadProductsForSelection();
          openModal('product-selection-modal');
        });
      }
      
      const closeProductSelectionBtn = document.getElementById('close-product-selection-modal');
      if (closeProductSelectionBtn) {
        closeProductSelectionBtn.addEventListener('click', () => {
          closeModal('product-selection-modal');
        });
      }
      
      // Recherche de produit
      const productSearchInput = document.getElementById('product-search-input');
      if (productSearchInput) {
        productSearchInput.addEventListener('input', (e) => {
          filterProductsForSelection(e.target.value);
        });
      }

      // Gestion de la soumission d'avis
      document.getElementById('add-review-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const produitInput = document.getElementById('review-produit');
        const produitNom = produitInput.value;
        const isAnonymous = document.getElementById('review-anonymous').checked;
        
        // Vérification que le produit est sélectionné (obligatoire)
        if (!produitNom) {
          alert('Veuillez sélectionner un produit pour votre avis.');
          return;
        }
        
        // Gestion du nom client (anonyme ou non)
        let clientName = document.getElementById('review-client').value.trim();
        
        // Le nom doit TOUJOURS être renseigné, même pour un avis anonyme
        if (!clientName) {
          alert('Veuillez saisir votre nom (obligatoire dans tous les cas).');
          return;
        }
        
        // Gestion des médias - Upload avant soumission de l'avis
        const mediaFiles = document.getElementById('review-media').files;
        let mediaUrls = [];
        
        if (mediaFiles.length > 0) {
          try {
            // Créer FormData pour l'upload
            const formData = new FormData();
            for (let i = 0; i < mediaFiles.length; i++) {
              formData.append('medias[]', mediaFiles[i]);
            }
            
            // Ajouter les informations du produit pour l'organisation des dossiers
            const produitId = produitInput.dataset.productId || produitNom.toLowerCase().replace(/[^a-z0-9]/g, '-');
            const categorie = produitInput.dataset.categorie || 'Divers';
            
            formData.append('produitId', produitId);
            formData.append('categorie', categorie);
            
            // Upload des médias
            const uploadResponse = await fetch('/api/upload-avis-media', {
              method: 'POST',
              body: formData
            });
            
            if (uploadResponse.ok) {
              const uploadResult = await uploadResponse.json();
              mediaUrls = uploadResult.files;
              console.log('Médias uploadés avec succès:', mediaUrls);
            } else {
              const error = await uploadResponse.text();
              throw new Error(`Erreur upload: ${error}`);
            }
          } catch (error) {
            console.error('Erreur upload médias:', error);
            alert('Erreur lors de l\'upload des médias: ' + error.message);
            return;
          }
        }

        const reviewData = {
          id: Date.now(),
          client: isAnonymous ? 'Anonyme' : clientName, // Nom affiché publiquement
          realName: clientName, // Nom réel toujours conservé pour l'admin
          isAnonymous: isAnonymous,
          titre: document.getElementById('review-titre').value.trim() || '',
          commentaire: document.getElementById('review-description').value.trim() || '',
          rating: selectedRating,
          date: new Date().toLocaleDateString('fr-FR'),
          medias: mediaUrls // URLs des fichiers uploadés
        };
        
        // Ajouter info produit (maintenant obligatoire)
        reviewData.produit = produitNom;
        reviewData.produitId = produitInput.dataset.productId || '';
        reviewData.categorie = produitInput.dataset.categorie || '';
        
        submitReview(reviewData);
      });
      
      // Gestion des étoiles de notation
      document.querySelectorAll('.rating-star').forEach(star => {
        star.addEventListener('click', () => {
          selectedRating = parseInt(star.dataset.rating);
          updateStars();
          updateRatingText();
        });
      });
      
      // Gestion de la checkbox anonyme
      document.getElementById('review-anonymous').addEventListener('change', (e) => {
        const clientInput = document.getElementById('review-client');
        if (e.target.checked) {
          // Le champ reste actif et obligatoire, mais on indique que l'affichage sera anonyme
          clientInput.placeholder = 'Votre nom (obligatoire, sera masqué publiquement)';
          clientInput.style.borderColor = '#ffd369';
        } else {
          clientInput.placeholder = 'Votre nom';
          clientInput.style.borderColor = '';
        }
      });
      
      // Fonction pour charger les produits dans la modal de sélection
      function loadProductsForSelection() {
        const grid = document.getElementById('product-selection-grid');
        grid.innerHTML = '';
        
        if (!articlesData || articlesData.length === 0) {
          grid.innerHTML = '<div style="text-align: center; color: rgba(255,255,255,0.7); padding: 40px;">Aucun produit disponible</div>';
          return;
        }
        
        articlesData.forEach((article, index) => {
          const productCard = document.createElement('div');
          productCard.className = 'product-selection-card';
          
          const mainImage = article.medias && article.medias.length > 0 
            ? article.medias[0].path 
            : (article.image || '');
          
          // Extraire seulement la catégorie finale du chemin
          const categoryParts = article.categorie ? article.categorie.split('/') : ['Sans catégorie'];
          const finalCategory = categoryParts[categoryParts.length - 1];
          
          // Tronquer le nom si trop long
          const truncatedName = article.nom.length > 25 ? article.nom.substring(0, 25) + '...' : article.nom;
          
          productCard.innerHTML = `
            <div class="product-selection-card-content">
              <h4 class="product-selection-title" title="${article.nom}">${truncatedName}</h4>
              <div class="product-selection-bottom">
                <div class="product-selection-image">
                  <img src="${mainImage}" alt="${article.nom}" style="${!mainImage ? 'display:none' : ''}">
                </div>
                <div class="product-selection-right">
                  <p class="product-selection-price">${article.prix}€</p>
                  <span class="product-selection-category">${finalCategory}</span>
                </div>
              </div>
            </div>
          `;
          
          productCard.addEventListener('click', () => {
            selectProduct(article);
          });
          
          grid.appendChild(productCard);
        });
      }
      
      // Fonction pour sélectionner un produit
      function selectProduct(product) {
        const selectedProductDiv = document.getElementById('selected-product');
        const hiddenInput = document.getElementById('review-produit');
        
        selectedProductDiv.innerHTML = `
          <div class="selected-product-info">
            <img src="${product.medias && product.medias.length > 0 ? product.medias[0].path : (product.image || '')}" 
                 alt="${product.nom}" class="selected-product-image" style="${!(product.medias && product.medias.length > 0) && !product.image ? 'display:none' : ''}">
            <div class="selected-product-details">
              <h4>${product.nom}</h4>
              <p>${product.prix}€</p>
              <span class="selected-category">${product.categorie || 'Produit'}</span>
            </div>
          </div>
        `;
        
        selectedProductDiv.classList.add('has-product');
        hiddenInput.value = product.nom;
        hiddenInput.dataset.productId = product.id;
        hiddenInput.dataset.categorie = product.categorie;
        
        closeModal('product-selection-modal');
      }
      
      // Fonction pour filtrer les produits
      function filterProductsForSelection(searchTerm) {
        const cards = document.querySelectorAll('.product-selection-card');
        cards.forEach(card => {
          const title = card.querySelector('.product-selection-title').textContent.toLowerCase();
          const category = card.querySelector('.product-selection-category').textContent.toLowerCase();
          
          if (title.includes(searchTerm.toLowerCase()) || category.includes(searchTerm.toLowerCase())) {
            card.style.display = 'block';
          } else {
            card.style.display = 'none';
          }
        });
      }

      // Fonction pour mettre à jour le texte de notation
      function updateRatingText() {
        const ratingTexts = {
          1: 'Très mécontent (1/5)',
          2: 'Mécontent (2/5)',
          3: 'Neutre (3/5)',
          4: 'Satisfait (4/5)',
          5: 'Très satisfait (5/5)'
        };
        const ratingTextElement = document.querySelector('.rating-text');
        if (ratingTextElement) {
          ratingTextElement.textContent = ratingTexts[selectedRating] || 'Très satisfait (5/5)';
        }
      }
      // Gestion des médias
      let selectedMediaFiles = [];
      let availableGalleryMedia = [];
      
      let mediaModalInitialized = false;
      let isMediaModalOpening = false;
      let mediaUploadClickHandler = null; // Référence pour l'event listener
      
      function initMediaUpload() {
        // Empêcher les initialisations multiples
        if (mediaModalInitialized) {
          return;
        }
        
        const mediaUploadBtn = document.getElementById('media-upload-btn');
        
        if (mediaUploadBtn) {
          // Créer le handler une seule fois
          mediaUploadClickHandler = function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.log('Bouton média cliqué, isMediaModalOpening:', isMediaModalOpening);
            if (!isMediaModalOpening) {
              openMediaSelectionModal();
            }
          };
          
          // Supprimer les anciens événements et ajouter le nouveau
          if (mediaUploadBtn.onclick) mediaUploadBtn.onclick = null;
          mediaUploadBtn.removeEventListener('click', mediaUploadClickHandler);
          mediaUploadBtn.addEventListener('click', mediaUploadClickHandler);
        }
        
        // Initialiser les événements de la modale de sélection de médias une seule fois
        initMediaSelectionModal();
        mediaModalInitialized = true;
      }
      
      function handleDeviceMediaSelection(e) {
        const files = Array.from(e.target.files);
        handleDeviceFiles(files);
      }
      
      function openMediaSelectionModal() {
        console.log('openMediaSelectionModal appelée, isMediaModalOpening:', isMediaModalOpening);
        if (isMediaModalOpening) {
          console.log('Modal déjà en cours d\'ouverture, ignoré');
          return;
        }
        
        isMediaModalOpening = true;
        const modal = document.getElementById('media-selection-modal');
        if (modal && !modal.classList.contains('show')) {
          // Utiliser le système spécial pour les modales de médias (ne ferme pas les autres)
          modal.classList.remove('hidden');
          modal.classList.add('show');
          console.log('Modal ouverte');
        } else {
          console.log('Modal déjà ouverte ou introuvable');
        }
        
        // Réinitialiser le flag après un délai plus court
        setTimeout(() => {
          isMediaModalOpening = false;
          console.log('Flag isMediaModalOpening réinitialisé');
        }, 200);
      }
      
      function closeMediaSelectionModal() {
        const modal = document.getElementById('media-selection-modal');
        modal.classList.remove('show');
        modal.classList.add('hidden');
      }
      
      function openDeviceInput() {
        document.getElementById('device-media-input').click();
      }
      
      function initMediaSelectionModal() {
        const closeBtn = document.getElementById('close-media-selection-modal');
        const deviceInput = document.getElementById('device-media-input');
        const dropZone = document.getElementById('upload-drop-zone');
        
        // Supprimer les anciens event listeners pour éviter les doublons
        if (closeBtn) {
          closeBtn.removeEventListener('click', closeMediaSelectionModal);
          closeBtn.addEventListener('click', closeMediaSelectionModal);
        }
        

        
        if (dropZone) {
          dropZone.removeEventListener('click', openDeviceInput);
          dropZone.addEventListener('click', openDeviceInput);
        }
        
        if (deviceInput) {
          deviceInput.removeEventListener('change', handleDeviceMediaSelection);
          deviceInput.addEventListener('change', handleDeviceMediaSelection);
        }
        
        // Drag & drop
        dropZone.addEventListener('dragover', (e) => {
          e.preventDefault();
          dropZone.classList.add('drag-over');
        });
        
        dropZone.addEventListener('dragleave', () => {
          dropZone.classList.remove('drag-over');
        });
        
        dropZone.addEventListener('drop', (e) => {
          e.preventDefault();
          dropZone.classList.remove('drag-over');
          const files = Array.from(e.dataTransfer.files);
          handleDeviceFiles(files);
        });
        
        // Boutons d'action
        document.getElementById('cancel-media-selection').addEventListener('click', () => {
          selectedMediaFiles = [];
          closeMediaSelectionModal();
          updateMediaPreview();
        });
        
        document.getElementById('validate-media-selection').addEventListener('click', () => {
          applyMediaSelection();
          closeMediaSelectionModal();
        });
      }
      
      function handleDeviceFiles(files) {
        files.forEach(file => {
          if (file.type.startsWith('image/') || file.type.startsWith('video/')) {
            selectedMediaFiles.push({
              type: 'device',
              file: file,
              url: URL.createObjectURL(file),
              name: file.name
            });
          }
        });
        updateSelectedMediaPreview('device');
        updateMediaCount();
      }
      
      function updateSelectedMediaPreview(tabType) {
        const preview = document.getElementById(`${tabType}-selected-preview`);
        const relevantMedia = selectedMediaFiles.filter(media => media.type === tabType);
        
        preview.innerHTML = '';
        
        relevantMedia.forEach((media, index) => {
          const mediaItem = document.createElement('div');
          mediaItem.className = 'selected-media-item';
          
          const isVideo = media.name.toLowerCase().includes('.mp4') || 
                         media.name.toLowerCase().includes('.mov') || 
                         media.name.toLowerCase().includes('.avi');
          
          mediaItem.innerHTML = `
            ${isVideo ? 
              `<video src="${media.url}" muted></video>` : 
              `<img src="${media.url}" alt="Preview">`
            }
            <button class="remove-selected" onclick="removeSelectedMedia(${selectedMediaFiles.indexOf(media)})">×</button>
          `;
          
          preview.appendChild(mediaItem);
        });
      }
      
      function removeSelectedMedia(index) {
        selectedMediaFiles.splice(index, 1);
        updateSelectedMediaPreview('device');
        updateMediaCount();
      }
      
      function updateMediaCount() {
        const count = selectedMediaFiles.length;
        const countElement = document.getElementById('selected-media-count');
        countElement.textContent = `${count} média${count > 1 ? 's' : ''} sélectionné${count > 1 ? 's' : ''}`;
        
        const validateBtn = document.getElementById('validate-media-selection');
        validateBtn.disabled = count === 0;
      }
      
      function applyMediaSelection() {
        // Appliquer la sélection au formulaire d'avis
        const preview = document.getElementById('media-preview');
        preview.innerHTML = '';
        
        // Créer un nouveau DataTransfer pour les fichiers device
        const dt = new DataTransfer();
        
        selectedMediaFiles.forEach((media, index) => {
          const mediaItem = document.createElement('div');
          mediaItem.className = 'media-preview-item';
          
          const isVideo = media.name.toLowerCase().includes('.mp4') || 
                         media.name.toLowerCase().includes('.mov') || 
                         media.name.toLowerCase().includes('.avi');
          
          mediaItem.innerHTML = `
            ${isVideo ? 
              `<video src="${media.url}" muted></video>` : 
              `<img src="${media.url}" alt="Preview">`
            }
            <button class="media-preview-remove" data-index="${index}" type="button">×</button>
          `;
          
          // Ajouter l'event listener pour la suppression
          const removeBtn = mediaItem.querySelector('.media-preview-remove');
          removeBtn.addEventListener('click', () => {
            removeMediaFromForm(index);
          });
          
          preview.appendChild(mediaItem);
          
          // Ajouter les fichiers device au DataTransfer
          if (media.type === 'device' && media.file) {
            dt.items.add(media.file);
          }
        });
        
        // Mettre à jour l'input file avec les fichiers device
        const reviewMediaInput = document.getElementById('review-media');
        reviewMediaInput.files = dt.files;
      }
      
      function removeMediaFromForm(index) {
        selectedMediaFiles.splice(index, 1);
        applyMediaSelection();
      }
      
      // Fonction globale pour la suppression depuis l'HTML
      window.removeSelectedMedia = removeSelectedMedia;
        
      // Chargement initial des données
      async function initializeData() {
        try {
          // S'assurer que la section articles est définie comme courante
          currentSection = 'articles';
          
          // S'assurer que la section articles est bien visible (elle a déjà active dans le HTML)
          const articlesSection = document.getElementById('articles-section');
          console.log('Section articles trouvée:', !!articlesSection);
          if (articlesSection) {
            console.log('Section articles active:', articlesSection.classList.contains('active'));
            if (!articlesSection.classList.contains('active')) {
              articlesSection.classList.add('active');
              console.log('Section articles activée manuellement');
            }
          }
          
          // Activer le bouton articles dans tous les menus
          document.querySelectorAll('#menu-articles, #menu-articles-desktop, #banner-articles').forEach(btn => {
            if (btn) btn.classList.add('active');
          });
          
          // Charger les données des articles
          console.log('Chargement des articles au démarrage...');
          await loadSectionData();
          
          // Initialiser l'upload de médias
          initMediaUpload();
          
          // Initialiser le bouton de fermeture de la modal d'avis
          const closeAddReviewBtn = document.getElementById('close-add-review-modal');
          if (closeAddReviewBtn) {
            closeAddReviewBtn.addEventListener('click', () => {
              closeModal('add-review-modal');
            });
          }
          
          // Charger les données pour les autres sections en arrière-plan
          const offresRes = await fetch('/offres.json');
          offresData = await offresRes.json();
          
          const arnaquesRes = await fetch('/arnaques.json');
          arnaquesData = await arnaquesRes.json();
          
          const preuvesRes = await fetch('/api/preuves');
          preuvesData = await preuvesRes.json();
          
          console.log('Toutes les données chargées en arrière-plan');
        } catch (error) {
          console.error('Erreur lors du chargement initial:', error);
        }
      }
      
      // Initialiser bouton panier au démarrage
      document.getElementById('cart-label').style.display = 'none';
      
      // Chargement initial des données et affichage
      initializeData().then(() => {
        updateStars();
        initSortDropdowns();
        console.log('Initialisation terminée - Articles chargés');
      });

      console.log('Initialisation terminée');
    }); // Fermeture du DOMContentLoaded
    
  </script>
</body>
</html>